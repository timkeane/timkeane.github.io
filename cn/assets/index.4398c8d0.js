import{i as e,j as t,O as a,F as n,S as o,C as i,a as s,V as l,b as r,I as c,G as d,P as u,c as p,d as f,e as g,L as m,W as h,f as v,T as b,t as y,g as w,D as _,o as I,h as C,k as S,l as E,M as x,R as k}from"./vendor.76151984.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const T={},P=function(e,t,a){if(!t||0===t.length)return e();const n=document.getElementsByTagName("link");return Promise.all(t.map((e=>{if(e=function(e,t){return new URL(e,t).href}(e,a),e in T)return;T[e]=!0;const t=e.endsWith(".css"),o=t?'[rel="stylesheet"]':"";if(!!a)for(let a=n.length-1;a>=0;a--){const o=n[a];if(o.href===e&&(!t||"stylesheet"===o.rel))return}else if(document.querySelector(`link[href="${e}"]${o}`))return;const i=document.createElement("link");return i.rel=t?"stylesheet":"modulepreload",t||(i.as="script",i.crossOrigin=""),i.href=e,document.head.appendChild(i),t?new Promise(((t,a)=>{i.addEventListener("load",t),i.addEventListener("error",(()=>a(new Error(`Unable to preload CSS for ${e}`))))})):void 0}))).then((()=>e()))},L=(e,t)=>{const a=e[t];return a?"function"==typeof a?a():Promise.resolve(a):new Promise(((e,a)=>{("function"==typeof queueMicrotask?queueMicrotask:setTimeout)(a.bind(null,new Error("Unknown variable dynamic import: "+t)))}))},D={translation:{"app.title":"Illinois BEAD Challenge","app.desc":"Illinois BEAD Challenge","banner.state_seal.alt":"Illinois Stae Seal","banner.bb_lab.alt":"Illinois Broadband Lab Logo","tab.map.name":"Map","tab.location.msg":"<p>Search for a location to display a list of Community Anchor Institutions and Broadband Service Locations.</p>","tab.locations.long_msg":'<p>The Illinois BEAD Challenge Map contains all up-to-date Broadband Serviceable Locations (BSLs) and Community Anchor Institutions (CAIs) in Illinois. This map can be used as a resource for participating in Illinois\' challenge process. Any location on this map can be challenged.</p><h2>How it works:</h2><ul><li>Search for an address or locate an area on the map using the zoom function.</li><li>Click on a location to view the availability of broadband, and whether this location is currently eligible for funding.</li><li>If you would like to challenge the information you see, select the location(s) and click "Add Challenge." Added locations will show up in the Challenges tab.</li><li>You can select locations on the map by using the Select tool <img src="img/select.svg" alt="Select tool" style="width:20px;height:20px">. Locations can be added one at a time by clicking on them, or you can lasso a group of locations by drawing a loop around multiple locations.</li><li>Once you have finished your selection process, click the "Submit Challenges" button and you will be forwarded to the Challenge Portal to upload evidence and complete the challenge process.</li></ul><p>There is no limit or minimum to the number of locations you can select to challenge, or number of times you can submit challenges.</p><p>If you have a file of pre-selected challenges with Location IDs, you can skip these steps and upload the file directly to the <a href="javascript:alert(\'no url\')">Challenge Portal</a>.</p>',"tab.challenge.msg":'<p class="message">Add a Challenge by clicking the challenge button on a Community Anchor Institution or Broadband Service Location in the Service Locations list, or by selecting locations on the map.</p>',"tab.locations.name":"Service Locations","tab.challenges.name":"Challenges","tab.challenges.new":"New Challenge","dialog.restore":"Would you like to restore the challenges from your last session?","dialog.always":"Always restore challenges","dialog.delete":"Are you sure you want to delete all challenges?","dialog.premature":"Challeng submission begins on","map.current_location":"Current Location","legend.name":"Layers","legend.served":"Served (Not eligible)","legend.underserved":"Underserved (Eligible)","legend.unserved":"Unserved (Eligible)","legend.filter":"Filter","form.search.placeholder":"Search for an address or ZIP Code...","form.challenges.submit":"Submit Challenges","form.challenges.table":"View challenges in table","form.challenges.save":"Save challenges as CSV","form.challenges.open":"Load challenges from CSV","form.challenges.delete":"Delete all challenges","layer.bsl.name":"Broadband Service Location","layer.cai.name":"Community Anchor Institution","layer.bg.name":"Census Block Group","feature.field.id":"Location ID","feature.field.service":"Serviceability","feature.field.enforce":"Enforceable Committment","feature.field.eligible":"Eligibility","feature.field.mdu":"Multiple Dwelling Units","feature.field.speed":"Speed","feature.field.provider":"Provider","feature.field.tech":"Technology","feature.field.type":"Type","feature.field.tr":"Tract","feature.field.bg":"Block Group","feature.field.fund":"Funding","feature.value.addr_state":"IL","feature.value.eligible":"Eligible","feature.value.not_eligible":"Not Eligible","feature.value.served":"Served","feature.value.underserved":"Underserved","feature.value.unserved":"Unserved","feature.value.enforce":"Enforceable","feature.value.not_enforce":"Not Enforceable","feature.value.n":"No","feature.value.y":"Yes","feature.value.0":"No","feature.value.1":"Yes","feature.value.s":"School","feature.value.l":"Library","feature.value.g":"Government facility","feature.value.h":"Health facility","feature.value.f":"Public Safety","feature.value.p":"Public Housing","feature.value.c":"Community Support Organization","feature.value.distance":"miles from your location","feature.value.rdof":"Rural Digital Opportunity Fund","feature.value.rep":"Rural Econnectivity Program","feature.value.tbcp":"Tribal Broadband Connectivity Program","feature.value.tlp":"Telephone Loan Program (TLP)","feature.value.caf_ii":"Connect America Fund Phase II","feature.value.ccgp":"Community Connect Grant Program","feature.value.bip":"Broadband Infrastructure Program","feature.value.bprt":"Bringing Puerto Rico Together","feature.value.cusvi":"Connect U.S. Virgin Islands","feature.field.state":"Ilinois","feature.value.unkown":"Unkown","feature.value.unavailable":"Unavailable","feature.value.submitted":"Already submitted","btn.add_challenge.name":"Add to Challenge","btn.how_it_works.name":"How it works","btn.remove_challenge.name":"Remove from Challenge","btn.yes.name":"Yes","btn.no.name":"No","btn.ok.name":"OK","btn.close.name":"Close","btn.back.name":"Back to the map","btn.select.name":"Select locations to challenge","btn.providers.name":"Providers","table.column.name":"Name","table.column.addr":"Address","table.column.city":"City","table.column.state":"State","table.column.zip":"ZIP Code","table.column.county":"County","table.column.lid":"Location ID","table.column.type":"Type","table.column.eligible":"Eligiblity","table.column.max_up":"Max Upload Speed","table.column.max_down":"Max Download Speed","table.column.mdu":"Muti Dwelling Units","table.column.service":"Servicibility","table.column.enforce":"Enforceable Commitment","table.column.blank":"",translate:"Translate","translate.en":"English","translate.es":"Español","translate.pl":"Polski","translate.he":"עִברִית","translate.yi":"יידיש"}},O=Object.freeze(Object.defineProperty({__proto__:null,default:D},Symbol.toStringTag,{value:"Module"})),F="en";const A={challenge:'<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48"><circle fill="" stroke="#000" stroke-width="3" cx="24" cy="24" r="19"/><circle fill="#111a52" stroke="#fff" stroke-width="3" cx="24" cy="24" r="16"/><path fill="#fff" transform="translate(12, 12)" d="M6.043 19.496l-1.482 1.505c-2.791-2.201-4.561-5.413-4.561-9.001s1.77-6.8 4.561-9l1.482 1.504c-2.326 1.835-3.804 4.512-3.804 7.496s1.478 5.661 3.804 7.496zm.675-7.496c0-1.791.887-3.397 2.282-4.498l-1.481-1.502c-1.86 1.467-3.04 3.608-3.04 6s1.18 4.533 3.04 6l1.481-1.502c-1.396-1.101-2.282-2.707-2.282-4.498zm15.043 0c0-2.984-1.478-5.661-3.804-7.496l1.482-1.504c2.791 2.2 4.561 5.412 4.561 9s-1.77 6.8-4.561 9.001l-1.482-1.505c2.326-1.835 3.804-4.512 3.804-7.496zm-6.761 4.498l1.481 1.502c1.86-1.467 3.04-3.608 3.04-6s-1.18-4.533-3.04-6l-1.481 1.502c1.396 1.101 2.282 2.707 2.282 4.498s-.886 3.397-2.282 4.498zm-3-7.498c-1.656 0-3 1.343-3 3s1.344 3 3 3 3-1.343 3-3-1.344-3-3-3z"/></svg>',served:'<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48"><circle fill="" stroke="#000" stroke-width="3" cx="24" cy="24" r="19"/><circle fill="#CC0202" stroke="#fff" stroke-width="3" cx="24" cy="24" r="16"/><path fill="#fff" transform="translate(12, 12)" d="M0 7.244c3.071-3.24 7.314-5.244 12-5.244 4.687 0 8.929 2.004 12 5.244l-2.039 2.15c-2.549-2.688-6.071-4.352-9.961-4.352s-7.412 1.664-9.961 4.352l-2.039-2.15zm5.72 6.034c1.607-1.696 3.827-2.744 6.28-2.744s4.673 1.048 6.28 2.744l2.093-2.208c-2.143-2.261-5.103-3.659-8.373-3.659s-6.23 1.398-8.373 3.659l2.093 2.208zm3.658 3.859c.671-.708 1.598-1.145 2.622-1.145 1.023 0 1.951.437 2.622 1.145l2.057-2.17c-1.197-1.263-2.851-2.044-4.678-2.044s-3.481.782-4.678 2.044l2.055 2.17zm2.622 1.017c-1.062 0-1.923.861-1.923 1.923s.861 1.923 1.923 1.923 1.923-.861 1.923-1.923-.861-1.923-1.923-1.923z"/></svg>',underserved:'<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48"><circle fill="" stroke="#000" stroke-width="3" cx="24" cy="24" r="19"/><circle fill="#F7B500" stroke="#fff" stroke-width="3" cx="24" cy="24" r="16"/><path fill="#fff" transform="translate(12, 12)" d="M0 7.244c3.071-3.24 7.314-5.244 12-5.244 4.687 0 8.929 2.004 12 5.244l-2.039 2.15c-2.549-2.688-6.071-4.352-9.961-4.352s-7.412 1.664-9.961 4.352l-2.039-2.15zm5.72 6.034c1.607-1.696 3.827-2.744 6.28-2.744s4.673 1.048 6.28 2.744l2.093-2.208c-2.143-2.261-5.103-3.659-8.373-3.659s-6.23 1.398-8.373 3.659l2.093 2.208zm3.658 3.859c.671-.708 1.598-1.145 2.622-1.145 1.023 0 1.951.437 2.622 1.145l2.057-2.17c-1.197-1.263-2.851-2.044-4.678-2.044s-3.481.782-4.678 2.044l2.055 2.17zm2.622 1.017c-1.062 0-1.923.861-1.923 1.923s.861 1.923 1.923 1.923 1.923-.861 1.923-1.923-.861-1.923-1.923-1.923z"/></svg>',unserved:'<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48"><circle fill="" stroke="#000" stroke-width="3" cx="24" cy="24" r="19"/><circle fill="#008450" stroke="#fff" stroke-width="3" cx="24" cy="24" r="16"/><path fill="#fff" transform="translate(12, 12)" d="M0 7.244c3.071-3.24 7.314-5.244 12-5.244 4.687 0 8.929 2.004 12 5.244l-2.039 2.15c-2.549-2.688-6.071-4.352-9.961-4.352s-7.412 1.664-9.961 4.352l-2.039-2.15zm5.72 6.034c1.607-1.696 3.827-2.744 6.28-2.744s4.673 1.048 6.28 2.744l2.093-2.208c-2.143-2.261-5.103-3.659-8.373-3.659s-6.23 1.398-8.373 3.659l2.093 2.208zm3.658 3.859c.671-.708 1.598-1.145 2.622-1.145 1.023 0 1.951.437 2.622 1.145l2.057-2.17c-1.197-1.263-2.851-2.044-4.678-2.044s-3.481.782-4.678 2.044l2.055 2.17zm2.622 1.017c-1.062 0-1.923.861-1.923 1.923s.861 1.923 1.923 1.923 1.923-.861 1.923-1.923-.861-1.923-1.923-1.923z"/></svg>',"y-eligible":'<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48"><rect fill="#000" x="3" y="3" width="42" height="42"/><rect fill="#fff" x="6" y="6" width="36" height="36"/><rect fill="#008450" x="9" y="9" width="30" height="30"/><path fill="#fff" transform="translate(12, 12)" d="M20.285 2l-11.285 11.567-5.286-5.011-3.714 3.716 9 8.728 15-15.285z"/></svg>',"n-eligible":'<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48"><rect fill="#000" x="3" y="3" width="42" height="42"/><rect fill="#fff" x="6" y="6" width="36" height="36"/><rect fill="#CC0202" x="9" y="9" width="30" height="30"/><path fill="#fff" transform="translate(13.2, 13.2) scale(0.9 0.9)" d="M24 20.188l-8.315-8.209 8.2-8.282-3.697-3.697-8.212 8.318-8.31-8.203-3.666 3.666 8.321 8.24-8.206 8.313 3.666 3.666 8.237-8.318 8.285 8.203z"/></svg>',trash:'<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48"><path fill="#111a52" transform="translate(6, 6) scale(1.5)" d="m20.015 6.506h-16v14.423c0 .591.448 1.071 1 1.071h14c.552 0 1-.48 1-1.071 0-3.905 0-14.423 0-14.423zm-5.75 2.494c.414 0 .75.336.75.75v8.5c0 .414-.336.75-.75.75s-.75-.336-.75-.75v-8.5c0-.414.336-.75.75-.75zm-4.5 0c.414 0 .75.336.75.75v8.5c0 .414-.336.75-.75.75s-.75-.336-.75-.75v-8.5c0-.414.336-.75.75-.75zm-.75-5v-1c0-.535.474-1 1-1h4c.526 0 1 .465 1 1v1h5.254c.412 0 .746.335.746.747s-.334.747-.746.747h-16.507c-.413 0-.747-.335-.747-.747s.334-.747.747-.747zm4.5 0v-.5h-3v.5z" fill-rule="nonzero"/></svg>'},z="rgba(0, 105, 217, .25)",B="rgb(0, 105, 217)",R="rgba(255, 240, 0, .8)",N="rgb(0, 105, 217)",U="rgba(237, 195, 128, .15)",V="rgba(0, 98, 204, .5)",M={},G={};function j(e,t,a){!function(e,t,a){if(void 0!==G.map)throw"store must only be called once";if(void 0===e)throw"store must be called with a map parameter";if(void 0===t)throw"store must be called with a locationTab parameter";if(void 0===a)throw"store must be called with a challengeTab parameter"}(e,t,a),G.map=e,G.locationTab=t,G.challengeTab=a}function q(e){const t=M[e];return M[e]=void 0===t?0:t+1,`${e}-${M[e]}`}function Y(e){return`data:image/svg+xml;utf8,${encodeURIComponent(A[e])}`}function Z(){return G.map}function J(){return G.map.get("caiLayer")}function W(){return G.map.get("bslLayer")}function X(){return G.map.get("bgLayer")}function H(){return G.map.get("challengeLayer")}function K(){return G.map.get("selectLayer")}function Q(){return G.map.get("drawLayer")}function ee(){return G.map.get("popupOverlay")}function te(){return G.challengeTab}function ae(e){return e===J()||e===W()}function ne(e,t,a){a=a||"1 = 1";const n=encodeURIComponent(a),o=`{"xmin":${t[0]},"ymin":${t[1]},"xmax":${t[2]},"ymax":${t[3]},"spatialReference":{"wkid":102100,"latestWkid":3857}}`;return`${e}&esriSpatialRelIntersects&geometry=${encodeURIComponent(o)}&where=${n}`}function oe(){return Z().get("locationOverlay")}function ie(e,t){for(const a in t){const n=t[a].filter;if(e.get(n[1][1])==n[2])return t[a]}}function se(e){const t=e.getView(),n=J(),o=W(),i=H().getSource(),s=K().getSource();function l(i){const s=$('<div class="pulse"></div>');$("body").append(s);const l=new a({element:s.get(0),offset:[-30,-30]});e.addOverlay(l);const r=i.feature,c=r.getId(),d=$(l.getElement());let u;u=c.indexOf("cai")>-1?n.getStyle():o.getStyle();const p=function(e,t,a){const n=ie(t,a)["icon-scale"],o=n[3],i=n[5],s=n[1][1],l=Math.floor(e.getZoom()),r=[];for(let d=o;d<=i;d++)r.push(d);const c=r.indexOf(l)+1;return Math.pow(s,c)/Math.pow(s,r.length)}(t,r,u),f=Math.floor(48*p),g=function(e,t){return ie(e,t)["icon-src"]}(r,u);d.css({"background-image":`url("${g}")`,"background-size":`${f}px`}).fadeIn(),l.setPosition(r.getGeometry().getCoordinates()),setTimeout((()=>{d.fadeOut((()=>{e.removeOverlay(l),l.dispose(),d.remove()}))}),3e3)}i.on("addfeature",l),s.on("addfeature",l)}function le(e,t){const a=[];for(let o=4;o<=17;o++)a.push(o);const n=a.indexOf(t)+1;return Math.pow(2,n)/Math.pow(2,a.length)}function re(){return[new s({fill:new n({color:U}),stroke:new o({color:V,width:3})})]}const ce=new l({}),de=new l({}),ue=new r({source:ce,style:function(e,t){const a=Z().getView(),l=56*le(0,Math.floor(a.getZoom())),r=new n({color:R}),c=new o({color:N,width:3}),d=new i({fill:r,stroke:c,radius:l});return[new s({image:d})]},minZoom:6});ue.set("name","selectLayer");const pe=new r({source:de,style:re,minZoom:6});function fe(e,t){const a=Z().getView(),l=le(0,Math.floor(a.getZoom())),r=56*l,d=new n({color:z}),u=new o({color:B,width:3}),p=new i({fill:d,stroke:u,radius:r}),f=new c({src:Y("challenge"),scale:l});return[new s({image:p}),new s({image:f})]}pe.set("name","drawLayer");const ge=[{},{prop:"name",name:"table.column.name",csv:"NAME"},{prop:"addr",name:"table.column.addr",csv:"ADDRESS"},{prop:"city",name:"table.column.city",csv:"CITY"},{prop:"state",name:"table.column.state",csv:"STATE"},{prop:"zip",name:"table.column.zip",csv:"ZIP"},{prop:"county",name:"table.column.county",csv:"COUNTY"},{prop:"lid",name:"table.column.lid",csv:"LOCATION_ID"},{prop:"type",name:"table.column.type",csv:"TYPE",decode:!0},{prop:"eligible",name:"table.column.eligible",csv:"ELIGIBILITY",decode:!0},{prop:"max_up",name:"table.column.max_up",csv:"MAX_UPLOAD_SPEED"},{prop:"max_down",name:"table.column.max_down",csv:"MAX_DOWNLOAD_SPEED"},{prop:"mdu",name:"table.column.mdu",csv:"MULTI_DWELLING_UNITS"},{prop:"service",name:"table.column.service",csv:"SERVICEABILITY",decode:!0},{prop:"enforce",name:"table.column.enforce",csv:"ENFORCEABLE_COMMITMENT",decode:!0}];function me(e){const t=$(e.target).data("feature");Be(e),$(`#table-${t.getId()}`).remove()}const he={quotes:!1,quoteChar:'"',escapeChar:'"',delimiter:",",header:!0,newline:"\n",skipEmptyLines:!1,columns:function(){const e=["FID_DO_NOT_EDIT","COORDINATE_DO_NOT_EDIT"];return ge.forEach((t=>{void 0!==t.csv&&e.push(t.csv)})),e}()},ve=new d({dataProjection:"EPSG:3857"});function be(){const e=[];return H().getSource().getFeatures().forEach((t=>{const a=function(e){const t={};return ge.forEach((a=>{t[a.csv]=e[a.prop]})),t}(t.getProperties());a.FID_DO_NOT_EDIT=t.getId(),a.COORDINATE_DO_NOT_EDIT=function(e){const t=e.getGeometry();return JSON.stringify(t.getCoordinates())}(t),e.push(a)})),encodeURIComponent(u.unparse(e,he))}function ye(e){const t=ve.writeFeatures(e);localStorage.setItem("challenges",t)}function we(){const e=localStorage.getItem("challenges");if(null!==e){const t=JSON.parse(e);if(t.features.length>0)return t}}function $e(e,t){if(void 0!==t){const a=ve.readFeatures(t);e.addFeatures(a)}}function _e(){localStorage.removeItem("challenges"),localStorage.removeItem("location")}function Ie(e){const t=u.parse(e.target.result,{...he,skipFirstNLines:1}).data,a=H().getSource();t.forEach((e=>{a.addFeature(function(e){const t={challenge:!0};ge.forEach((a=>{a.csv&&(t[a.prop]=e[a.csv])})),t.geometry=new p(JSON.parse(e.COORDINATE_DO_NOT_EDIT));const a=new f(t);return a.setId(e.FID_DO_NOT_EDIT),a}(e))}))}function Ce(e){const t=e.target.files[0],a=new FileReader;a.onload=Ie,a.readAsText(t)}const Se=new bootstrap.Modal("#dialog",{}),Ee=$("#dialog .modal-body"),xe=$("#dialog button.yes"),ke=$("#dialog button.no"),Te=$("#dialog button.ok"),Pe=$("#dialog input.always");function Le(e,t){Se.hide(),e(t)}function De(){const e=te().attr("aria-labelledby");return $(`#${e}`)}function Oe(){De().attr("data-i18n","tab.challenges.name").removeAttr("aria-alert").removeClass("new").localize()}function Fe(e){e.preventDefault();const t=H().getSource().getFeatures(),a={cai:[],bsl:[]};t.forEach((e=>{e.getId().indexOf("cai")>-1?a.cai.push({location_id:e.get("lid"),name:e.get("name"),address:e.get("addr"),zip:e.get("zip")}):a.bsl.push(e.get("lid"))})),st.addFeatures(t),function(e){const t=ve.writeFeatures(e);localStorage.setItem("submission",t)}(st.getFeatures()),Ve(!0),console.warn(a)}function Ae(e){const t=function(e){return e instanceof f?e:$(e.target).data("feature")}(e),a=H().getSource();t.set("challenge",!0),a.addFeature(t),De().addClass("new").attr("data-i18n","tab.challenges.new;[aria-alert]tab.challenges.new").one("click",Oe).localize(),ye(a.getFeatures()),ze(!1)}function ze(e){G.challengeTab.find("form").find("button").each(((t,a)=>{$(a).hasClass("open")||$(a).prop("disabled",e)}))}function Be(e){const t=$(e.target).data("feature"),a=H().getSource();t.set("challenge",!1),a.removeFeature(t),ye(a.getFeatures()),0===a.getFeatures().length&&(Oe(),ze(!0))}function Re(e){e.preventDefault();!function(e){const t=$('<table class="table"><thead><tr></tr></thead><tbody></tbody><table>'),a=t.find("thead tr"),n=t.find("tbody");ge.forEach((e=>{const t=e.name,n=$("<th></th>");a.append(n),void 0!==t&&n.attr("data-i18n",t)})),e.forEach((e=>{const t=e.getId(),a=$(`<tr id="table-${t}"></tr>`);n.append(a),ge.forEach((t=>{var n,o;const i=$("<td></td>"),s=t.prop;if(void 0===s){const t=$("<img>"),a=$(`<img role="button" src="${Y("trash")}" data-i18n="[alt]btn.remove_challenge.name;[title]btn.remove_challenge.name">`).data("feature",e).on("click",me),s=null==(n=e.get("service"))?void 0:n.toLowerCase(),l=null==(o=e.get("eligible"))?void 0:o.toLowerCase();if(void 0!==s)t.attr("src",Y(s)).attr("data-i18n",`[alt]feature.value.${s};[title]feature.value.${s}`);else{const e="y"===l?"eligible":"not_eligible";t.attr("src",Y(`${l}-eligible`)).attr("data-i18n",`[alt]feature.value.${e};[title]feature.value.${e}`)}i.append(t).append(a)}else{const a=e.get(s);if(t.decode&&void 0!==a){const e=(a+"").toLowerCase();i.attr("data-i18n",`feature.value.${e}`)}else i.html(a).addClass(void 0===a?"empty":"")}a.append(i)}))}));const o=$("#container"),i=$('<div class="challenge-table" style="display:none"></div>'),s=$('<button class="btn btn-primary back" data-i18n="[aria-label]btn.back.name;[title]btn.back.name"></button>').on("click",(()=>{$("body").removeClass("challenge-table"),i.slideUp((()=>{i.remove(),o.attr("aria-hidden",!1)}))}));$(t.find("thead th").get(0)).append(s),i.append(t).css("top",o.get(0).offsetTop+"px"),$("body").addClass("challenge-table").append(i),i.localize().slideDown((()=>o.attr("aria-hidden",!0)))}(H().getSource().getFeatures())}function Ne(e){e.preventDefault(),function(){const e=`data:text/csv;charset=utf-8,${be()}`,t=$('<a class="csv-download"><img></a>');$("body").append(t),t.attr({href:e,download:"Illinois-BEAD-challenge.csv"}).find("img").trigger("click"),t.remove()}()}function Ue(e){e.preventDefault(),function(){let e=$("#load-csv");0===e.length&&(e=$('<input id="load-csv" type="file">'),$("body").append(e),e.on("change",Ce)),e.trigger("click")}()}function Ve(e){if(e){const e=H().getSource();e.getFeatures().forEach((t=>{t.set("challenge",!1),e.removeFeature(t)})),_e(),ze(!0)}}function Me(e){var t;e.preventDefault(),t=Ve,Ee.attr("data-i18n","dialog.delete").localize(),xe.show().one("click",(()=>Le(t,!0))),ke.show().one("click",(()=>Le(t,!1))),Te.hide(),$("#dialog .always").hide(),Se.show()}function Ge(e){e.preventDefault(),function(){const e=new Date("Jan 8 2023 00:00:00 CST");Ee.html(`&nbsp;${e.toLocaleString()}`).attr("data-i18n","[prepend]dialog.premature").localize(),xe.hide(),ke.hide(),Te.show().on("click",(()=>Se.hide())),$("#dialog .always").hide(),Se.show()}()}function je(e,t){!function(e){const t={};["delete","table","save","open"].forEach((a=>{const n=$('<button class="btn btn-primary"></button>').attr("data-i18n",`[title]form.challenges.${a};[aria-label]form.challenges.${a}`).prop("disabled","open"!==a).addClass(`sm ${a}`);t[a]=n,e.append(n)})),t.save.on("click",Ne),t.open.on("click",Ue),t.table.on("click",Re),t.delete.on("click",Me)}(e),ze(!t),function(e){const t=new Date("Jan 8 2023 00:00:00 CST").getTime();(new Date).getTime()>t?e.on("submit",Fe):e.on("submit",Ge)}(e),e.localize()}Pe.on("change",(()=>{var e;e=Pe.is(":checked"),localStorage.setItem("always",e)})),$("#challenge-tab").on("show.bs.tab",(()=>{$("#locate")[$(window).width()<972?"hide":"show"]()})),$("#challenge-tab").on("hide.bs.tab",(()=>$("#locate").show()));const qe=["location","challenge","popup"];function Ye(e){const t=e.max_up;return"0"==`${t}`?'<span data-i18n="feature.value.unkown"/>':t+"/"+e.max_down+" mb/s"}function Ze(e,t){const a=[],n=t?"button.challenge":"";return qe.forEach((t=>{"challenge"!==t&&a.push(`#${Je(e,t)} ${n}`)})),$(a.join())}function Je(e,t){return`${t}-${e.getId()}`}function We(e,t){const a=e.get("challenge"),n=$(`<button class="btn btn-primary challenge" data-i18n="${a?"btn.remove_challenge.name":"btn.add_challenge.name"}"></button>`).on("click",a?Be:Ae).data("feature",e);t.append(n)}function Xe(e){const t=e.feature,a=null!==st.getFeatureById(t.getId()),n=t.get("challenge"),o=Ze(t,!0);if(a)o.each(((e,t)=>{const a=$('<div class="submitted" data-i18n="feature.value.submitted"></div>');$(t).replaceWith(a.localize())}));else{const e=n?"btn.remove_challenge.name":"btn.add_challenge.name";o.attr("data-i18n",e).off("click",n?Ae:Be).on("click",n?Be:Ae).localize()}setTimeout((()=>{Z().get("popupOverlay").panIntoView()}),500),function(e,t){const a=Ze(e),n=t?"addClass":"removeClass";a.each(((e,t)=>{const a=$(t).parent();if("LI"===a.prop("nodeName"))a[n]("challenge");else{const e=Z().get("popupOverlay").getElement();$(e)[n]("challenge")}}))}(t,!a||n),"addfeature"===e.type&&ze(!1)}function He(e){const t=e.get("distance");if(void 0!==t){const e=$('<label data-i18n="feature.value.distance"></label>').localize(),a=(t/1609.34).toFixed(2);return $(`<div class="distance">${a} mi</div>`).attr("aria-label",`${a} ${e.html()}`)}return""}function Ke(e,t){return e.replace(t,"")}const Qe="https://services.arcgis.com/R0IGaIgf2sox9aCY/arcgis/rest/services/IL_June2023BDC_LocationID_with_ProviderID/FeatureServer/22/query?f=geojson&outFields=provider_id",et="https://services.arcgis.com/R0IGaIgf2sox9aCY/ArcGIS/rest/services/IL_June2023BDC_Providers_with_ProviderID/FeatureServer/4/query?f=geojson&outFields=brand_name%20as%20name,technology%20as%20tech,max_download_speed%20as%20max_down,max_upload_speed%20as%20max_up&orderByFields=brand_name%20ASC,technology%20ASC";function tt(e,t){console.error({message:`Could not fetch providers for Location_ID=${t.get("lid")}`,error:e})}function at(e){const t=$(e.target),a=t.data("feature"),n=t.find("tbody");void 0===a.get("providers")&&(t.addClass("loading"),function(e){return new Promise(((t,a)=>{if(void 0!==e.get("providers"))t(e);else{const a=encodeURIComponent(`location_id=${e.get("lid")}`);fetch(`${Qe}&where=${a}`).then((a=>{a.json().then((a=>{const n=[];if(a.features.forEach((e=>{n.push(e.properties.provider_id)})),n.length>0){const a=encodeURIComponent(`provider_id IN (${n.join()})`);fetch(`${et}&where=${a}`).then((a=>{a.json().then((a=>{const n=[];a.features.forEach((e=>{n.push(e.properties)})),e.set("providers",n,!0),t(e)}))})).catch((t=>tt(t,e)))}else e.set("providers",[]),t(e)}))})).catch((t=>tt(t,e)))}}))}(a).then((e=>{const a=e.get("providers");a.length>0?a.forEach((e=>{const t=$("<tr></tr>").append(`<td>${e.name}</td>`).append(`<td>${e.tech}</td>`).append(`<td>${Ye(e)}</td>`);n.append(t)})):n.append('<tr><td  colspan="3" data-i18n="feature.value.unserved"></td></tr>').localize(),t.removeClass("loading")})).catch((e=>tt(e,a))))}function nt(e,t){var a,n;const o=Je(e,t),i=null!==st.getFeatureById(e.getId()),s=e.get("lid"),l=`${e.get("city")}, <span data-i18n="feature.value.addr_state"></span> ${e.get("zip")}`,r=Ke(e.get("addr"),l),c=null==(a=e.get("service"))?void 0:a.toLowerCase(),d=1===e.get("enforce")?"y":"n",u=null==(n=e.get("fund"))?void 0:n.toLowerCase(),p=e.get("mdu"),f=$(`<div id="${o}" class="feature-html ${`bsl ${t} ${c} ${d}`}"><h4 data-i18n="[prepend]layer.bsl.name"></h4></div>`).append(He(e)).append(`<div class="addr">${r}<br>${l}</div>`).append(`<div class="county">${e.get("county")} COUNTY</div>`).append(`<div class="location-id"><span class="field" data-i18n="[prepend]feature.field.id">:</span> <span>${s}</span></div>`).append(`<div class="enfoce"><span class="field" data-i18n="[prepend]feature.field.enforce">:</span> <span data-i18n="feature.value.${d}"></span></div>`).append(void 0!==u?`<div class="fed-fund"><span class="field" data-i18n="[prepend]feature.field.fund">:</span> <span data-i18n="feature.value.${u}"></span></div>`:"").append(`<div class="service"><span class="field" data-i18n="[prepend]feature.field.service">:</span> <span data-i18n="feature.value.${c}"></span></div>`).append(p>1?`<div class="mdu"><span class="field" data-i18n="[prepend]feature.field.mdu">:</span> <span>${p}</span></div>`:"").append(function(e){const t=`prov-${e.getId()}`,a=$(`<table id="${t}" class="collapse hide provider">\n    <thead>\n      <th data-i18n="feature.field.provider"/>\n      <th data-i18n="feature.field.tech"/>\n      <th data-i18n="feature.field.speed"/>\n    </thead>\n    <tbody></tbody>\n  </table>`).data("feature",e),n=$(`<button\n    type="button"\n    class="btn btn-primary providers"\n    data-bs-toggle="collapse"\n    data-bs-target="#${t}"\n    aria-expanded="false"\n    data-i18n="btn.providers.name">\n  </button>`);return a.get(0).addEventListener("show.bs.collapse",at),[n,a]}(e));return i?f.append('<div class="submitted" data-i18n="feature.value.submitted"></div>'):We(e,f),f.localize()}function ot(e,t){const a=Je(e,t),n=0===e.get("lid")?e.get("lid"):'<span data-i18n="feature.value.unavailable"/>',o=null!==st.getFeatureById(e.getId()),i=`${e.get("city")}, <span data-i18n="feature.value.addr_state"></span> ${e.get("zip")}`,s=Ke(e.get("addr"),i),l=e.get("eligible").toLowerCase(),r=e.get("type").toLowerCase(),c=Ye(e.getProperties()),d=$(`<div id="${a}" class="feature-html ${`cai ${t} ${l}`}"><h4 data-i18n="layer.cai.name"></h4></div>`).append(He(e)).append(`<div class="addr">${s}<br>${i}</div>`).append(`<div class="county">${e.get("county")} COUNTY</div>`).append(`<div class="location-id"><span class="field" data-i18n="[prepend]feature.field.id">:</span> <span>${n}</span></div>`).append(`<div class="eligible"><span class="field" data-i18n="[prepend]feature.field.eligible">:</span> <span data-i18n="feature.value.${l}"></span></div>`).append(`<div class="type"><span class="field" data-i18n="[prepend]feature.field.type">:</span> <span data-i18n="feature.value.${r}"></span></div>`).append(`<div class="speed"><span class="field" data-i18n="[prepend]feature.field.speed">:</span> <span>${c}</span></div>`);return o?d.append('<div class="submitted" data-i18n="feature.value.submitted"></div>'):We(e,d),d.localize()}function it(e){return e.getId().indexOf("bsl")?nt(e):ot(e)}const st=new l;function lt(e){const t=new l;e?function(e){$e(e,we())}(t):_e();const a=new r({source:t,style:fe,minZoom:12});return a.set("name","challengeLayer"),a.set("featureHtml",it),t.on("addfeature",Xe),t.on("removefeature",Xe),a}$e(st,function(){const e=localStorage.getItem("submission");return null!==e?JSON.parse(e):{type:"FeatureCollection",features:[]}}());class rt extends d{constructor(e){super(e),this.idPrefix=e.idPrefix,this.idProp=e.idProp}readFeatureFromObject(e,t){const a=super.readFeatureFromObject(e,t);return a.setId(this.idPrefix+a.get(this.idProp)),a}}class ct extends rt{constructor(e){super(e)}getType(){return"arraybuffer"}readFeature(e,t){const a=g(new Uint8Array(e));return super.readFeature(a.featureCollection,t)}readFeatures(e,t){const a=g(new Uint8Array(e));return super.readFeatures(a.featureCollection,t)}}class dt extends l{constructor(e){super(e),this.filterUrl=e.url}loadFeatures(e,t,a){const n=setInterval((()=>{this.loading||(clearInterval(n),this.dispatchEvent("loadcomplete"))}),100);super.loadFeatures(e,t,a)}filter(e){this.setUrl(((t,a,n)=>this.filterUrl(t,a,n,e))),this.refresh()}}class ut extends m{constructor(e){super(e),this.style=e.style}createRenderer(){return new h(this,{style:this.style})}getStyle(){return this.style}}const pt=[{filter:["==",["get","service"],"SERVED"],"icon-src":Y("served"),"icon-size":[48,48],"icon-scale":["interpolate",["exponential",2],["zoom"],4,0,17,1]},{filter:["==",["get","service"],"UNDERSERVED"],"icon-src":Y("underserved"),"icon-size":[48,48],"icon-scale":["interpolate",["exponential",2],["zoom"],4,0,17,1]},{filter:["==",["get","service"],"UNSERVED"],"icon-src":Y("unserved"),"icon-size":[48,48],"icon-scale":["interpolate",["exponential",2],["zoom"],4,0,17,1]}],ft=`${"https://services.arcgis.com/R0IGaIgf2sox9aCY/arcgis/rest/services/IL_BSLFile_2023_12_06_Final/FeatureServer/0/query?f=pbf&outSR=3857&outFields=locationid%20as%20lid,address%20as%20addr,city,zipcode%20as%20zip,county,serviceability%20as%20service,enforceable_commitment%20as%20enforce,funding_program%20as%20fund,mdu"}&token=${"AAPK075a045352e64bd583ef4645224e213fBIBCnmrqPubNPP2Sxmi9DxqvDgDZBX1Toq4nMJu4bYGkd_TyL-Oaf426BVzX5-UW"}`;function gt(e){const t={},a=$(e.target),n=a.hasClass("enforce")?"input.filter.enforce":"input.filter.mdu";$(n).prop("checked",a.is(":checked")),$("input.filter").each(((e,a)=>{$(a).is(":checked")&&(t[$(a).data("where")]=!0)}));const o=a.data("layer").getSource(),i=Object.keys(t).join(" AND ");o.filter(i)}function mt(e,t){e.add(t).data("layer",W()).on("change",gt),e.data("where","enforceable_commitment = 1"),t.data("where","mdu > 1")}const ht=new ut({source:new dt({format:new ct({dataProjection:"EPSG:3857",idPrefix:"bsl-",idProp:"lid"}),url:function(e,t,a,n){return ne(ft,e,n)},strategy:v}),style:pt,minZoom:14});ht.set("name","bsl"),ht.set("featureHtml",nt);const vt={"stroke-color":"rgb(17, 26, 82)","stroke-width":3},bt=new ut({source:new l({format:new b,url:"data/boundary.json"}),style:vt,minZoom:4,maxZoom:5}),yt={"stroke-color":"rgba(17, 26, 82, .25)","stroke-width":3,"fill-color":"rgba(17, 26, 82, 0.1)"},wt=`${"https://services.arcgis.com/R0IGaIgf2sox9aCY/arcgis/rest/services/Block_Groups_2020_US_Census_Bureau/FeatureServer/0/query?f=pbf&outSR=3857&outFields=FID,BLKGRP%20as%20bg,TRACT%20as%20tr,Shape__Area%20as%20area"}&token=${"AAPK075a045352e64bd583ef4645224e213fBIBCnmrqPubNPP2Sxmi9DxqvDgDZBX1Toq4nMJu4bYGkd_TyL-Oaf426BVzX5-UW"}`;const $t=new ut({source:new l({format:new ct({dataProjection:"EPSG:3857",idPrefix:"bg-",idProp:"FID"}),url:function(e,t,a){return ne(wt,e)},strategy:y(w({tileSize:512}))}),style:yt,minZoom:10,visible:!1});$t.set("name","bg");const _t=[{filter:["==",["get","eligible"],"Y"],"icon-src":Y("y-eligible"),"icon-size":[48,48],"icon-scale":["interpolate",["exponential",2],["zoom"],4,0,17,1]},{filter:["==",["get","eligible"],"N"],"icon-src":Y("n-eligible"),"icon-size":[48,48],"icon-scale":["interpolate",["exponential",2],["zoom"],4,0,17,1]}],It=`${"https://services.arcgis.com/R0IGaIgf2sox9aCY/ArcGIS/rest/services/IL_CAI_2023_12_06_Final/FeatureServer/1/query?f=pbf&outSR=3857&outFields=OBJECTID,locationid%20as%20lid,name,type,address%20as%20addr,city,zipcode%20as%20zip,county,eligibility%20as%20eligible,max_download%20as%20max_down,max_upload%20as%20max_up"}&token=${"AAPK075a045352e64bd583ef4645224e213fBIBCnmrqPubNPP2Sxmi9DxqvDgDZBX1Toq4nMJu4bYGkd_TyL-Oaf426BVzX5-UW"}`;const Ct=new ut({source:new dt({format:new ct({dataProjection:"EPSG:3857",idPrefix:"cai-",idProp:"OBJECTID"}),url:function(e,t,a){return ne(It,e)},strategy:v}),style:_t,minZoom:14});Ct.set("name","cai"),Ct.set("featureHtml",ot);const St="https://geocode-api.arcgis.com/arcgis/rest/services/World/GeocodeServer/",Et="AAPK075a045352e64bd583ef4645224e213fBIBCnmrqPubNPP2Sxmi9DxqvDgDZBX1Toq4nMJu4bYGkd_TyL-Oaf426BVzX5-UW",xt=encodeURIComponent('{"xmin":-10190000,"ymin":4420000,"xmax":-9750000,"ymax":52390000,"spatialReference":{"wkid":102100,"latestWkid":3857}}'),kt=`findAddressCandidates?f=pjson&outSR=3857&token=${Et}&searchExtent=${xt}&singleLine=`,Tt=`suggest?f=json&token=${Et}&searchExtent=${xt}&text=`;function Pt(e){const t=$("#search").val();e.preventDefault(),$("#locate button").addClass("loading"),$("#possible").slideUp(),function(e){const t=`${St}${kt}${encodeURIComponent(e)}`;return new Promise(((e,a)=>{fetch(t).then((t=>{t.json().then((t=>{t.error&&a(t.error),e(t.candidates)})).catch((e=>{console.error(e),a(e)}))})).catch((e=>{console.error(e),a(e)}))}))}(t).then((t=>{t.length>0&&(1===t.length||100===t[0].score?Ot(t[0],$(e.target).data("view")):function(e){Dt(e,"address")}(t))})).catch((e=>console.error(e)))}function Lt(e){if("Enter"!==e.code){const e=$("#search").val();e.length>3&&function(e){const t=`${St}${Tt}${encodeURIComponent(e)}`;return new Promise(((e,a)=>{fetch(t).then((t=>{t.json().then((t=>{t.error&&a(t.error),e(t.suggestions)})).catch((e=>{console.error(e),a(e)}))})).catch((e=>{console.error(e),a(e)}))}))}(e).then((e=>{!function(e){Dt(e,"text")}(e)})).catch((e=>console.error(e)))}}function Dt(e,t){const a={},n=$("#possible").empty();e.forEach((e=>{const o=e[t];if(!a[o]){const e=$(`<li class="list-group-item">${o}</li>`);a[o]=!0,e.on("click",(t=>{n.slideUp(),$("#search").val(e.html()),$("#locate").trigger("submit")})),n.append(e)}})),n.slideDown()}function Ot(e,t){const a=[e.location.x,e.location.y];if(n=t.getCenter(),o=a,n[0]!==o[0]||n[1]!==o[1]){const n=e.address,o=oe();o.setPosition(a),t.animate({zoom:16,center:a},(()=>{$(o.getElement()).attr("title",n).attr("aria-label",n)})),function(e){localStorage.setItem("location",JSON.stringify(e))}(e)}else $("#locate button").removeClass("loading");var n,o}function Ft(e,t,n){const o=$('<div class="form-group search-map"><ul id="possible" class="list-group"></ul><button type="submit" class="btn btn-primary" data-i18n="[aria-label]search"><div></div></button></div>'),i=$('<input type="text" class="form-control" id="search" data-i18n="[placeholder]form.search.placeholder;[aria-label]form.search.placeholder">');t.prepend(o.prepend(i)).localize(),$("body").append('<div id="location" class="location"></div>'),i.on("click",(()=>i.select())),$(document).on("click",(()=>$("#possible").slideUp()));const s=new a({element:$("#location").get(0),offset:[-16,-28],className:"overlay-0 ol ol-overlay-container ol-selectable"}),l=e.getView();if(e.addOverlay(s),e.set("locationOverlay",s),$(t).data("view",l).on("submit",Pt),$("#search").on("keyup",Lt),n){$("#locate button").addClass("loading");const e=function(){const e=localStorage.getItem("location");if(null!==e)return JSON.parse(e)}();Ot(e,l),$("#search").val(e.address)}}const At=$('<div id="wait"></div>');$("body").append(At);const zt=new a({element:At.get(0),offset:[-20,-20],className:"overlay-3 ol ol-overlay-container ol-selectable"});window.waitOverlay=zt;class Bt extends C{constructor(e){const t=$('<button data-i18n="btn.add_challenge.name"></button>');super({element:$('<div class="add-selection ol-unselectable ol-control"></div>').append(t).localize().get(0)}),this.selectedSource=e.selectedSource,this.challengeSource=e.challengeSource,t.on("click",this.addChallenges.bind(this)),this.selectedSource.on("change",this.hideShow.bind(this))}hideShow(){const e=this.selectedSource.getFeatures();$(".add-selection")[e.length>0?"fadeIn":"fadeOut"]()}addChallenges(){const e=this.getMap().getView();zt.setPosition(e.getCenter()),setTimeout((()=>{this.selectedSource.getFeatures().forEach((e=>{Ae(e)})),this.selectedSource.clear(),zt.setPosition(void 0)}),100)}}function Rt(e){const t=Z();if(function(e){return e.getControls().getArray().filter((e=>e.get("select")))[0].getActive()}(t)){const a=K().getSource(),n=Q().getSource();let o=!0;t.forEachFeatureAtPixel(e.pixel,((e,t)=>{o=!1;const n=e.getId();if(!(null!==st.getFeatureById(n))&&void 0!==n){const t=a.getFeatureById(n);null===t?a.addFeature(e):a.removeFeature(t)}}),{layerFilter:ae}),o&&(a.clear(),n.clear())}}function Nt(e){const t=e.feature.getGeometry(),a=Mt();zt.setPosition(Z().getView().getCenter()),setTimeout((()=>{!function(e,t){const a=K().getSource();t.forEach((t=>{if(null===st.getFeatureById(t.getId())){const n=t.getGeometry().getCoordinates();e.intersectsCoordinate(n)&&a.addFeature(t)}})),zt.setPosition(void 0)}(t,a)}),100)}function Ut(e,t){const a=t.getGeometry().getCoordinates(),n=new S([e,a]).getLength();t.set("distance",n)}function Vt(e){const t=oe().getPosition();if(t){if(1===e.length)return Ut(t,e[0]),e;e.sort(((e,a)=>{Ut(t,e),Ut(t,a);const n=e.get("distance"),o=a.get("distance");return n<o?-1:n>o?1:0}))}return e}function Mt(){const e=Z(),t=e.getView(),a=J(),n=W(),o=a.getSource(),i=n.getSource(),s=t.calculateExtent(e.getSize()),l=a.getVisible()?o.getFeaturesInExtent(s):[],r=n.getVisible()?i.getFeaturesInExtent(s):[];return Vt(l.concat(r))}function Gt(e){const t=G.locationTab.find("form"),a=$('button[aria-controls="how-it-works"]'),n="true"===a.attr("aria-expanded"),o=e.children().length>0;t[o?"show":"hide"](),n&&o&&a.trigger("click"),n||o||a.trigger("click")}function jt(e,t){t.find("form");const a=e.children().length>0;t.find(".message")[a?"hide":"show"]()}function qt(e,t,a){const n=$('<li class="list-group-item"></li>').addClass(t.getId().indexOf("cai")>-1?"cai":"bsl").append(a(t,"location"));e.append(n)}function Yt(){const e=$("#location-list").empty(),t=Mt(),a=J().get("featureHtml"),n=W().get("featureHtml");t.forEach((t=>{t.getId().indexOf("cai")>-1?qt(e,t,a):qt(e,t,n)})),Gt(e),$("#locate button").removeClass("loading")}function Zt(e){const t=e.feature;$(`#${Je(t,"challenge")}`).parent().remove(),jt($("#challenge-list"),te())}function Jt(e){const t=W(),a=J(),n=e.feature||e,o=(-1===n.getId().indexOf("bsl")?a:t).get("featureHtml"),i=$("#challenge-list"),s=$('<li class="list-group-item"></li>').append(o(n,"challenge"));i.append(s),jt(i,te())}const Wt=`${"https://basemapstyles-api.arcgis.com/arcgis/rest/services/styles/v2/styles/osm/light-gray"}?token=${"AAPK075a045352e64bd583ef4645224e213fBIBCnmrqPubNPP2Sxmi9DxqvDgDZBX1Toq4nMJu4bYGkd_TyL-Oaf426BVzX5-UW"}`;function Xt(t,a){const n=`${Wt}&language=${e.language}`;return new Promise(((e,o)=>{E(t,n).then((t=>{const n=lt(a),o=ht.getSource(),i=Ct.getSource();o.on("loadcomplete",Yt),i.on("loadcomplete",Yt),ht.on("change:visible",Yt),Ct.on("change:visible",Yt),t.addLayer(bt),t.addLayer($t),t.addLayer(ue),t.addLayer(pe),t.addLayer(n),t.addLayer(ht),t.addLayer(Ct),t.set("bgLayer",$t),t.set("selectLayer",ue),t.set("drawLayer",pe),t.set("caiLayer",Ct),t.set("bslLayer",ht),t.set("challengeLayer",n),e(t)})).catch((e=>{console.error(e),o(e)}))}))}const Ht=$('<div id="popup" class="popup"><a href="#" id="popup-closer" class="popup-closer" data-i18n=[aria-label]btn.close.name}" rel="noopener"></a><div id="popup-content"></div></div>');function Kt(e){e.setPosition(void 0),$("#popup").css("opacity",0).show()}function Qt(e){if(ee().active){const t=e.map,a=[];t.forEachFeatureAtPixel(e.pixel,((e,t)=>{t.get("name");const n=t.get("featureHtml");a.push(n(e,"popup"))}),{layerFilter:ae,hitTolerance:50}),function(e,t,a){const n=$("#popup").attr("dir",$("html").attr("dir")),o=e.get("popupOverlay"),i=$("#popup-content");if(a.length>0){const e=a[0];i.empty().append(e).data("htmlFeatures",a),o.setPosition(t),n.animate({opacity:1}),$("#popup-closer").one("click",(e=>{n.fadeOut((()=>Kt(o)))}))}}(t,e.coordinate,a)}}function ea(e){$("#popup"),this.active=e,setTimeout((()=>{Kt(this),e||$("popup").hide()}),500)}function ta(e){const t=$(e.target),a=$("#map-tab"),n=$("#map"),o=$("#map-container"),i=t.get(0)===a.get(0),s=a.is(":visible");s&&!i?$("body").append(o.addClass("wayout")):s&&i?n.append(o.removeClass("wayout")):o.removeClass("wayout")}window.dealWithMap=ta,$(".nav-link").on("click",ta);class aa extends a{constructor(e){const t=$(e.map.getTargetElement()).find(".feature-tip").get(0);super({id:q("feature-tip"),element:t||$(aa.HTML).get(0),offset:[5,5],className:"overlay-1 ol ol-overlay-container ol-selectable"}),this.setMap(e.map),this.map=this.getMap(),this.tip=$(this.getElement()),this.addTips(e.tips),this.map.on("pointermove",this.label.bind(this))}hide(){this.tip.fadeOut((()=>{this.setPosition(void 0)}))}addTips(e){e.forEach((e=>{e.layer.tip=e.label}))}out(e){$.contains(this.map.getTargetElement(),e.target)||this.hide()}label(e){const t=this.map.forEachFeatureAtPixel(e.pixel,((e,t)=>t&&t.getVisible()&&t.tip?t.tip(e):null));t?(this.tip.html(t.html),this.tip.addClass(t.css),this.setPosition(e.coordinate),this.tip.localize().show(),this.position()):this.hide()}position(){const e=this.map.getSize(),t=this.tip.width(),a=this.tip.height(),n=this.map.getPixelFromCoordinate(this.getPosition()),o=n[1]+a>e[1]?"bottom":"top",i=n[0]+t>e[0]?"right":"left";this.setPositioning(`${o}-${i}`)}}function na(e){const t=e.get("name"),a=1===e.get("eligible")?"feature.value.eligible":"feature.value.not_eligible";const n=$("<div></div>").append(`<span class="name">${t}</span>`).append(` (<span class="tip-prop" data-i18n="${a}"></span>)`);return{html:$('<div><div class="title" data-i18n="layer.cai.name"></div></div>').append(n)}}function oa(e){var t;const a=e.get("addr"),n=function(e){return"Y"===e?"feature.value.enforce":"feature.value.not_enforce"}(e.get("enforce")),o=e.get("fund"),i=null==(t=e.get("service"))?void 0:t.toLowerCase(),s=e.get("mdu"),l=$("<div></div>").append(`<div class="address">${a}</div>`).append(`(<span class="enforce" data-i18n="${n}" />`).append(void 0!==o?`, <span class="fund">${o}</span>`:"").append(`, <span data-i18n="feature.value.${i}"></span>`).append(s>0?`, <span class="mdu">MDU ${s}</span>)`:")");return{html:$('<div><div class="title" data-i18n="layer.bsl.name"></div></div>').append(l)}}function ia(e){const t=e.get("tr"),a=e.get("bg");return{html:$(`<div>\n    <div class="title" data-i18n="[prepend]feature.field.tr"> ${t}</div>\n    <div class="title" data-i18n="[prepend]feature.field.bg"> ${a}</div>\n  </div>`)}}aa.TipDef,aa.LabelFunction,aa.Label,aa.Options,aa.HTML='<div class="feature-tip" role="tooltip"></div>';class sa extends C{constructor(e){const t=$('<button class="legend-opener" data-i18n="[title]legend.name"></button>');super({element:$('<div class="legend ol-unselectable ol-control ol-collapsed"></div>').append(t).append(e).get(0)}),this.legend=e.hide(),this.button=t,t.on("click",this.show.bind(this)),e.find(".legend-closer").on("click",this.hide.bind(this))}show(){$(this.element).removeClass("ol-collapsed").addClass("ol-expanded").prop("dir",$("html").prop("dir")),this.button.hide(),this.legend.fadeIn()}hide(){this.legend.fadeOut((()=>{$(this.element).removeClass("ol-expanded").addClass("ol-collapsed"),this.button.show()}))}}function la(e){const t=$(e.target),a=t.data("layer"),n=t.is(":checked"),o=a.get("name");a.setVisible(n),$(`#location-list li.${o}`)[n?"show":"hide"]()}const ra=new x({target:"map-container"});function ca(e){const t=$("#locations"),n=$("#challenges");j(ra,t,n),Xt(ra,e).then((o=>{if(function(){const e=ra.getControls().getArray().filter((e=>e instanceof k))[0];ra.removeControl(e)}(),function(){let e=!0;const t=$(".col-sm-4");$(window).on("resize",(a=>{const n=$("#map-container");$(window).width()>972?($(".col-sm-8").append(n),t.addClass("col-sm-4"),$("#location-tab").trigger("click")):($("#map").append(n),t.removeClass("col-sm-4"),e&&(e=!1,$("#location-tab").trigger("click")))}))}(),je($("#challenge"),e),Ft(o,$("#locate"),e),function(e,t,a){e.getView();const n=H().getSource(),o=$('<ul id="location-list" class="list-group"></ul>'),i=$('<ul id="challenge-list" class="list-group"></ul>');t.append(o),a.append(i),mt(t.find("input.enforce"),t.find("input.mdu")),n.on("addfeature",Jt),n.on("removefeature",Zt),n.getFeatures().forEach((e=>{Jt(e)}))}(o,t,n),function(e){const t=K(),a=Q().getSource(),n=t.getSource(),o=H().getSource();ee();const i=new _({source:a,type:"Polygon",freehand:!0,style:re}),s=new I({className:"select",interaction:i,active:!1,onToggle:t=>{Q().setVisible(t),ee().setActive(!t),$(e.getTargetElement())[t?"addClass":"removeClass"]("draw-select")}});$(s.getButtonElement()).addClass("select-button"),s.set("select",!0),e.addOverlay(zt),e.addControl(s),e.addInteraction(i),e.addControl(new Bt({selectedSource:n,challengeSource:o})),i.on("drawend",Nt),e.on("singleclick",Rt)}(o),function(e){new aa({map:e,tips:[{layer:J(),label:na},{layer:W(),label:oa},{layer:X(),label:ia}]})}(o),se(o),function(e){$("body").append(Ht);const t=$("#popup"),n=new a({element:t.get(0),autoPan:{animation:{duration:250}},className:"overlay-2 ol ol-overlay-container ol-selectable"});n.active=!0,n.setActive=ea,$("#popup-content").data("map",e),e.addOverlay(n),e.set("popupOverlay",n),e.on("singleclick",Qt)}(o),function(e){const t=$("#legend"),a=e.getView();t.find("#cai-check").data("layer",J()).on("change",la),t.find("#bsl-check").data("layer",W()).on("change",la),t.find("#bg-check").data("layer",X()).on("change",la),a.on("change:resolution",(()=>{const e=a.getZoom();t.find("input").each(((t,a)=>{const n=$(a).data("layer");if($(a).prop("disabled",e<=n.getMinZoom()),"checkbox"===$(a).attr("type")){const e=a.id;"enforce-check"!==e&&"mdu-check"!==e&&$(a).prop("checked",n.getVisible())}}))})),new sa(t).setMap(e),mt(t.find("input.enforce"),t.find("input.mdu"))}(o),!e){const e=o.getView(),t={VITE_SUBMIT_DATE:"Jan 8 2023 00:00:00 CST",VITE_CENTER:"[-9963555, 4836210]",VITE_ZOOM:"5",VITE_SEARCH_EXTENT:'{"xmin":-10190000,"ymin":4420000,"xmax":-9750000,"ymax":52390000,"spatialReference":{"wkid":102100,"latestWkid":3857}}',VITE_LANGUAGES:'["en", "es", "pl", "he"]',VITE_ARC_TOKEN:"AAPK075a045352e64bd583ef4645224e213fBIBCnmrqPubNPP2Sxmi9DxqvDgDZBX1Toq4nMJu4bYGkd_TyL-Oaf426BVzX5-UW",VITE_BASEMAP_URL:"https://basemapstyles-api.arcgis.com/arcgis/rest/services/styles/v2/styles/osm/light-gray",VITE_CAI_URL:"https://services.arcgis.com/R0IGaIgf2sox9aCY/ArcGIS/rest/services/IL_CAI_2023_12_06_Final/FeatureServer/1/query?f=pbf&outSR=3857&outFields=OBJECTID,locationid%20as%20lid,name,type,address%20as%20addr,city,zipcode%20as%20zip,county,eligibility%20as%20eligible,max_download%20as%20max_down,max_upload%20as%20max_up",VITE_BSL_URL:"https://services.arcgis.com/R0IGaIgf2sox9aCY/arcgis/rest/services/IL_BSLFile_2023_12_06_Final/FeatureServer/0/query?f=pbf&outSR=3857&outFields=locationid%20as%20lid,address%20as%20addr,city,zipcode%20as%20zip,county,serviceability%20as%20service,enforceable_commitment%20as%20enforce,funding_program%20as%20fund,mdu",VITE_BG_URL:"https://services.arcgis.com/R0IGaIgf2sox9aCY/arcgis/rest/services/Block_Groups_2020_US_Census_Bureau/FeatureServer/0/query?f=pbf&outSR=3857&outFields=FID,BLKGRP%20as%20bg,TRACT%20as%20tr,Shape__Area%20as%20area",VITE_BSL_PROVIDER_URL:"https://services.arcgis.com/R0IGaIgf2sox9aCY/arcgis/rest/services/IL_June2023BDC_LocationID_with_ProviderID/FeatureServer/22/query?f=geojson&outFields=provider_id",VITE_PROVIDER_URL:"https://services.arcgis.com/R0IGaIgf2sox9aCY/ArcGIS/rest/services/IL_June2023BDC_Providers_with_ProviderID/FeatureServer/4/query?f=geojson&outFields=brand_name%20as%20name,technology%20as%20tech,max_download_speed%20as%20max_down,max_upload_speed%20as%20max_up&orderByFields=brand_name%20ASC,technology%20ASC",BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0},a=JSON.parse(t.VITE_CENTER),n=1*t.VITE_ZOOM;e.setZoom(n),e.setCenter(a)}o.once("postrender",(()=>{$("body").removeClass("loading"),$(window).trigger("resize"),$("#search").trigger("focus")})),function(){const e=["en","es","pl","he","yi"];let t=0,a=0;const n=$(".banner .dropdown .btn-primary"),o=setInterval((()=>{t=t<e.length-1?t+1:0,a+=1,a===10*e.length?(n.attr("data-i18n","translate").localize(),clearInterval(o)):n.attr("data-i18n",`translate.${e[t]}`).localize()}),1e3)}()}))}$(".ol-attribution button").addClass("attribution"),new Promise(((a,n)=>{const o=function(){const e=document.location.search,t={};return e&&e.substring(1).split("&").forEach((e=>{const a=e.split("=");t[a[0]]=a[1]})),(t.locale||navigator.language).split("-")[0]}(),i={en:D};(function(e){return new Promise(((t,a)=>{e!==F?L(Object.assign({"./en/translation.js":()=>P((()=>Promise.resolve().then((()=>O))),void 0,import.meta.url),"./es/translation.js":()=>P((()=>import("./translation.e892db26.js")),[],import.meta.url),"./he/translation.js":()=>P((()=>import("./translation.3e89be1b.js")),[],import.meta.url),"./iw/translation.js":()=>P((()=>import("./translation.40164a9b.js")),[],import.meta.url),"./pl/translation.js":()=>P((()=>import("./translation.c5ac457c.js")),[],import.meta.url),"./yi/translation.js":()=>P((()=>import("./translation.b1678bea.js")),[],import.meta.url)}),`./${e}/translation.js`).then((a=>{void 0!==a&&t({locale:e,translation:a})})).catch((a=>{console.warn(`No translations for locale="${e}"`),t({locale:F})})):t({locale:F})}))})(o).then((n=>{const o=n.locale;o!==F&&(i[o]=n.translation.default,$("#map-container").attr("dir","ltr"),$("html").attr("lang",o).attr("dir",i[o].translation.dir||"ltr")),e.init({defaultLocale:F,fallbackLng:F,defaultNS:"translation",resources:i,lng:o},((n,o)=>{t.init(e,$,{useOptionsAttr:!0}),$("[data-i18n]").localize(),a(i)}))}))})).catch((e=>console.error("Failed to initialize i18n"))).then((()=>{var e;void 0!==we()?"true"===localStorage.getItem("always")?ca(!0):(e=ca,Ee.attr("data-i18n","dialog.restore").localize(),xe.show().one("click",(()=>Le(e,!0))),ke.show().one("click",(()=>Le(e,!1))),Te.hide(),$("#dialog .always").show(),Se.show()):ca(!1)}));
