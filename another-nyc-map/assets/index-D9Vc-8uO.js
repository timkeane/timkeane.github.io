import{$ as e,i as t,j as o,C as n,p as a,r as s,F as i,g as r,a as l,P as c,b as d,c as p,S as u,d as h,e as m,G as g,V as f,f as b,O as E,L as y,W as v,h as _,o as T,k as S,l as C,M as I,m as L,D as w,n as O,q as N,K as $,s as P,t as A,u as R,T as k,X as D,v as V,w as x}from"./vendor-CeZ7p1En.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const o of e)if("childList"===o.type)for(const e of o.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const F={},B=function(e,t,o){let n=Promise.resolve();if(t&&t.length>0){const e=document.getElementsByTagName("link"),a=document.querySelector("meta[property=csp-nonce]"),s=(null==a?void 0:a.nonce)||(null==a?void 0:a.getAttribute("nonce"));n=Promise.allSettled(t.map((t=>{if(t=function(e,t){return new URL(e,t).href}(t,o),t in F)return;F[t]=!0;const n=t.endsWith(".css"),a=n?'[rel="stylesheet"]':"";if(!!o)for(let o=e.length-1;o>=0;o--){const a=e[o];if(a.href===t&&(!n||"stylesheet"===a.rel))return}else if(document.querySelector(`link[href="${t}"]${a}`))return;const i=document.createElement("link");return i.rel=n?"stylesheet":"modulepreload",n||(i.as="script"),i.crossOrigin="",i.href=t,s&&i.setAttribute("nonce",s),document.head.appendChild(i),n?new Promise(((e,o)=>{i.addEventListener("load",e),i.addEventListener("error",(()=>o(new Error(`Unable to preload CSS for ${t}`))))})):void 0})))}function a(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return n.then((t=>{for(const e of t||[])"rejected"===e.status&&a(e.reason);return e().catch(a)}))},j="en";function G(e){return new Promise(((t,o)=>{e!==j?((e,t,o)=>{const n=e[t];return n?"function"==typeof n?n():Promise.resolve(n):new Promise(((e,n)=>{("function"==typeof queueMicrotask?queueMicrotask:setTimeout)(n.bind(null,new Error("Unknown variable dynamic import: "+t+(t.split("/").length!==o?". Note that variables only represent file names one level deep.":""))))}))})(Object.assign({"./translations/en.js":()=>B((()=>import("./en-C3cyqzB2.js")),[],import.meta.url),"./translations/es.js":()=>B((()=>import("./es-BDJRssAU.js")),[],import.meta.url)}),`./translations/${e}.js`,3).then((o=>{void 0!==o&&t({locale:e,translation:o})})).catch((o=>{console.warn(`No translations for locale="${e}"`),t({locale:j})})):t({locale:j})}))}const M=["en","es"];function z(o){const a=e('<select class="form-control form-select btn translate" name="translate" data-i18n="[title]translate;[aria-label]translate">\n  <option value="0" data-i18n="translate.en"></option>\n</select>').localize();o.addControl(new n({element:a.get(0)})),a.on("change",(()=>{window.location.search=`?locale=${a.val()}`})),M.forEach((e=>{a.append(`<option data-i18n="locale.${e}" value="${e}"></option>`).localize()}));let s=0;const i=a.children().first(),r=setInterval((()=>{s=s<M.length-1?s+1:0,i.attr("data-i18n",`translate.${M[s]}`).localize()}),1e3);a.on("click",(()=>{i.attr("data-i18n",`translate.${t.language||j}`).localize(),clearInterval(r)})),setTimeout((()=>{clearInterval(r),a.remove()}),12e4)}const H={1:"Manhattan",2:"Bronx",3:"Brooklyn",4:"Queens",5:"Staten Island",MANHATTAN:"Manhattan",BRONX:"Bronx",BROOKLYN:"Brooklyn",QUEENS:"Queens","STATEN IS":"Staten Island",MN:"Manhattan",BX:"Bronx",BK:"Brooklyn",QN:"Queens",SI:"Staten Island"};function U(e){return H[e]}function K(e,t){let o=(null==e?void 0:e.trim())||"";for(;o.length<t;)o=`0${o}`;return o}const Y={};function q(e){return Y[e]=Y[e]?Y[e]+1:1,`${e}${Y[e]}`}function W(e,t){return Object.keys(t).forEach((o=>{const n=void 0!==t[o]?t[o]:"";e=e.replace(new RegExp("\\$\\{"+o+"\\}","g"),n)})),e}function X(e){return e.replace(/\./g,"").replace(/\'/g,"").replace(/ /g,"-").replace(/\'/g,"").replace(/á/g,"").replace(/é/g,"").replace(/í/g,"").replace(/é/g,"").replace(/ó/g,"").replace(/ú/g,"").replace(/ü/g,"").replace(/ñ/g,"")}function Z(e,t,o){return a(e,t,o)}function J(e){if(e){const t=q("shp:");return a.defs(t,e),s(a),t}}a.defs([["EPSG:2263","+proj=lcc +lat_1=41.03333333333333 +lat_2=40.66666666666666 +lat_0=40.16666666666666 +lon_0=-74 +x_0=300000.0000000001 +y_0=0 +ellps=GRS80 +datum=NAD83 +units=ft +to_meter=0.3048006096012192 +no_defs"],["EPSG:6539","+proj=lcc +lat_1=40.66666666666666 +lat_2=41.03333333333333 +lat_0=40.16666666666666 +lon_0=-74 +x_0=300000 +y_0=0 +ellps=GRS80 +units=us-ft +no_defs"]]);class Q extends i{constructor(e){super(e=e||{}),this.dataProjection=r(e.dataProjection||"EPSG:4326"),this.featureProjection=r(e.featureProjection||"EPSG:3857")}readFeature(e,t){const o=new l(e);return this.setGeometry(o,e,t),o}setGeometry(e,t,o){try{const o=t[this.x]=parseFloat(t[this.x]),n=t[this.y]=parseFloat(t[this.y]),a=new c([o,n]).transform(this.dataProjection,this.featureProjection);e.setGeometry(a)}catch(n){console.warn("Failed to parse location from source",t,n)}}readFeatures(e,t){const o=[];return(e=this.parseSource(e)).forEach((e=>{try{o.push(this.readFeature(e,t))}catch(n){console.error(n,e)}})),o}parseSource(e){return e instanceof ArrayBuffer&&(e=(new TextDecoder).decode(e)),"string"==typeof e&&(e=d.parse(e,{header:!0}).data),this.detectCsvFormat(e),e}detectCsvFormat(e){e[0].longitude&&(this.x="longitude"),e[0].long&&(this.x="long"),e[0].lng&&(this.x="lng"),e[0].Longitude&&(this.x="Longitude"),e[0].Long&&(this.x="Long"),e[0].Lng&&(this.x="Lng"),e[0].LONGITUDE&&(this.x="LONGITUDE"),e[0].LONG&&(this.x="LONG"),e[0].LNG&&(this.x="LNG"),e[0].latitude&&(this.y="latitude"),e[0].lat&&(this.y="lat"),e[0].Latitude&&(this.y="Latitude"),e[0].Lat&&(this.y="Lat"),e[0].LATITUDE&&(this.y="LATITUDE"),e[0].LAT&&(this.y="LAT")}readProjection(e){return this.dataProjection}getType(){return"arraybuffer"}}let ee,te,oe;e("body").append('<div id="dialog" class="modal fade" data-bs-keyboard="false" data-bs-backdrop="static" tabindex="-1" aria-hidden="true">\n  <div id="modal" class="modal-dialog">\n    <div class="modal-content">\n      <h2 class="dialog-header">\n        <span class="title"></span>\n        <a class="btn-close corner" href="#" aria-role="button"\n          data-i18n="[title]close;[aria-label]close">\n        </a>\n      </h2>\n      <div class="modal-body">\n        <form class="template-form">\n          <select class="form-control form-select" name="address" \n            data-i18n="[title]csv.address;[aria-label]csv.address">\n          </select>\n          <select class="form-control form-select" name="borough"\n            data-i18n="[title]csv.borough;[aria-label]csv.borough">\n          </select>\n          <select class="form-control form-select" name="city"\n            data-i18n="[title]csv.city;[aria-label]csv.city">\n          </select>\n          <select class="form-control form-select" name="zip"\n            data-i18n="[title]csv.zip;[aria-label]csv.zip">\n          </select>\n          <div class="submit">\n            <button class="btn btn-primary template" name="submit">OK</button>\n          </div>\n        </form>\n        <form class="load-form">\n          <div>\n            <input id="load-csv" class="form-check-input" name="load" type="radio" value="csv" checked>\n            <label for="load-csv" data-i18n="input.file.csv"></label>\n          </div>\n          <div>\n            <input id="load-shp" class="form-check-input" name="load" type="radio" value="shp">\n            <label for="load-shp" data-i18n="input.file.shp"></label>\n          </div>\n          <div>\n            <input id="load-geo" class="form-check-input" name="load" type="radio" value="geo">\n            <label for="load-geo" data-i18n="input.file.geo"></label>\n          </div>\n          <div>\n            <input id="load-url" class="form-check-input" name="load" type="radio" value="url">\n            <label for="load-url" data-i18n="input.url.geo"></label>\n          </div>\n          <input class="form-control name" name="name" type="text" data-i18n="[placeholder]placeholder.layer.name" autocomplete="on">\n          <input class="form-control csv shp geo" name="file" type="file" accept=".csv">\n          <input class="form-control url" name="url" type="text" data-i18n="[placeholder]placeholder.url" autocomplete="on">\n          <div class="submit">\n            <button class="btn btn-primary load" data-i18n="load.layer" name="submit"></button>\n          </div>\n        </form>\n        <form class="alert-form">\n          <div class="message"></div>\n          <div class="submit">\n            <button class="btn btn-primary load" name="submit">OK</button>\n          </div>\n        </form>\n      </div>\n    </div>\n  </div>\n</div>');const ne=new bootstrap.Modal("#dialog"),ae=e("#dialog form.load-form"),se=e("#dialog form.template-form"),ie=e("#dialog form.alert-form"),re=e("#dialog h2 span");function le(e){ie.hide(),ae.hide(),se.hide(),re.localize(),e.localize().show(),ne.show(),setTimeout((()=>e.children().first().trigger("focus")),500)}function ce(){ee=null,te=null,oe=null,re.html(""),e('#dialog input[type="text"], #dialog select').val(null),ne.hide()}ae.find('input[type="radio"]').on("click",(()=>{const t=ae.get(0).load.value;e('#dialog input.url, #dialog input[type="file"]').hide(),e('#dialog input[type="file"]').attr("accept",{csv:".csv",shp:".shp,.dbf,.prj",geo:".json,.geojson"}[t]).prop("multiple","shp"===t),e(`#dialog input.${t}`).show()})),e("#dialog .btn-close").on("click",ce),ie.on("submit",(function(e){e.preventDefault(),ce()})),se.on("submit",(function(e){const t={};e.preventDefault(),se.find("select").each(((e,o)=>{const n=o.value;"0"!==n&&(t[o.name]=n)})),oe(t),ne.hide()})),ae.on("submit",(function(e){var t;const o=ae.get(0);if(e.preventDefault(),(null==(t=o.file)?void 0:t.files.length)>0||o.url.value.length>0){const e=e=>{o.name.value&&e.set("name",o.name.value),te.addLayer(e)};"url"===o.load.value?ee.loadUrl(o.url.value,e):ee.loadFile(o.file.files,e),ne.hide()}}));const de={assemblyDistrict:!1,bbl:!1,bblBoroughCode:!1,bblTaxBlock:!1,bblTaxLot:!1,bikeLane:!1,bikeLane2:!1,bikeTrafficDirection:!1,boardOfElectionsPreferredLgc:!1,boePreferredStreetName:!1,boePreferredstreetCode:!1,boroughCode1In:!1,buildingIdentificationNumber:!1,businessImprovementDistrict:!1,cdta2020:!1,censusBlock2000:!1,censusBlock2010:!1,censusBlock2020:!1,censusTrack2020:!1,censusTract1990:!1,censusTract2000:!1,censusTract2010:!1,censusTract2020:!1,cityCouncilDistrict:!1,civilCourtDistrict:!1,coincidentSegmentCount:!1,communityDistrict:!1,communityDistrictBoroughCode:!1,communityDistrictNumber:!1,communitySchoolDistrict:!1,condominiumBillingBbl:!1,congressionalDistrict:!1,cooperativeIdNumber:!1,crossStreetNamesFlagIn:!1,dcpCommercialStudyArea:!1,dcpPreferredLgc:!1,dcpZoningMap:!1,dotStreetLightContractorArea:!1,dynamicBlock:!1,electionDistrict:!1,featureTypeCode:!1,fireBattalion:!1,fireCompanyNumber:!1,fireCompanyType:!1,fireDivision:!1,firstBoroughName:!1,firstStreetCode:!1,firstStreetNameNormalized:!1,fromActualSegmentNodeId:!1,fromLionNodeId:!1,fromPreferredLgcsFirstSetOf5:!1,genericId:!1,geosupportFunctionCode:!1,geosupportReturnCode:!1,geosupportReturnCode2:!1,gi5DigitStreetCode1:!1,gi5DigitStreetCode2:!1,gi5DigitStreetCode3:!1,gi5DigitStreetCode4:!1,gi5DigitStreetCode5:!1,giBoroughCode1:!1,giBoroughCode2:!1,giBoroughCode3:!1,giBoroughCode4:!1,giBoroughCode5:!1,giBuildingIdentificationNumber1:!1,giBuildingIdentificationNumber2:!1,giBuildingIdentificationNumber3:!1,giBuildingIdentificationNumber4:!1,giBuildingIdentificationNumber5:!1,giDcpPreferredLgc1:!1,giDcpPreferredLgc2:!1,giDcpPreferredLgc3:!1,giDcpPreferredLgc4:!1,giDcpPreferredLgc5:!1,giGeographicIdentifier3:!1,giHighHouseNumber1:!1,giHighHouseNumber2:!1,giHighHouseNumber4:!1,giHighHouseNumber5:!1,giLowHouseNumber1:!1,giLowHouseNumber2:!1,giLowHouseNumber4:!1,giLowHouseNumber5:!1,giSideOfStreetIndicator1:!1,giSideOfStreetIndicator2:!1,giSideOfStreetIndicator3:!1,giSideOfStreetIndicator4:!1,giSideOfStreetIndicator5:!1,giStreetCode1:!1,giStreetCode2:!1,giStreetCode3:!1,giStreetCode4:!1,giStreetCode5:!1,giStreetName1:!1,giStreetName2:!1,giStreetName3:!1,giStreetName4:!1,giStreetName5:!1,healthArea:!1,healthCenterDistrict:!1,highBblOfThisBuildingsCondominiumUnits:!1,highCrossStreetB5SC1:!1,highCrossStreetCode1:!1,highCrossStreetName1:!1,highHouseNumberOfBlockfaceSortFormat:!1,houseNumber:!1,houseNumberIn:!1,houseNumberSortFormat:!1,hurricaneEvacuationZone:!1,individualSegmentLength:!1,instructionalRegion:!1,interimAssistanceEligibilityIndicator:!1,internalLabelXCoordinate:!1,internalLabelYCoordinate:!1,latitude:!1,latitudeInternalLabel:!1,legacySegmentId:!1,lionBoroughCode:!1,lionBoroughCodeForVanityAddress:!1,lionFaceCode:!1,lionFaceCodeForVanityAddress:!1,lionKey:!1,lionKeyForVanityAddress:!1,lionSequenceNumber:!1,lionSequenceNumberForVanityAddress:!1,listOf4Lgcs:!1,longitude:!1,longitudeInternalLabel:!1,lowBblOfThisBuildingsCondominiumUnits:!1,lowCrossStreetB5SC1:!1,lowCrossStreetCode1:!1,lowCrossStreetName1:!1,lowHouseNumberOfBlockfaceSortFormat:!1,lowHouseNumberOfDefiningAddressRange:!1,message:!1,nta:!1,nta2020:!1,numberOfCrossStreetB5SCsHighAddressEnd:!1,numberOfCrossStreetB5SCsLowAddressEnd:!1,numberOfCrossStreetsHighAddressEnd:!1,numberOfCrossStreetsLowAddressEnd:!1,numberOfEntriesInListOfGeographicIdentifiers:!1,numberOfExistingStructuresOnLot:!1,numberOfStreetFrontagesOfLot:!1,physicalId:!1,policePatrolBoroughCommand:!1,policePrecinct:!1,policeSector:!1,pumaCode:!1,reasonCode:!1,reasonCode1e:!1,returnCode1a:!1,returnCode1e:!1,roadwayType:!1,rpadBuildingClassificationCode:!1,rpadSelfCheckCodeForBbl:!1,sanbornBoroughCode:!1,sanbornPageNumber:!1,sanbornVolumeNumber:!1,sanitationBulkPickupSchedule:!1,sanitationCollectionSchedulingSectionAndSubsection:!1,sanitationCommercialWasteZone:!1,sanitationDistrict:!1,sanitationOrganicsCollectionSchedule:!1,sanitationRecyclingCollectionSchedule:!1,sanitationRegularCollectionSchedule:!1,sanitationSection:!1,segmentAzimuth:!1,segmentIdentifier:!1,segmentLengthInFeet:!1,segmentOrientation:!1,segmentTypeCode:!1,sideOfStreetIndicator:!1,sideOfStreetOfVanityAddress:!1,specialAddressGeneratedRecordFlag:!1,splitLowHouseNumber:!1,stateSenatorialDistrict:!1,streetName1In:!1,streetStatus:!1,taxMapNumberSectionAndVolume:!1,toActualSegmentNodeId:!1,toLionNodeId:!1,toPreferredLgcsFirstSetOf5:!1,trafficDirection:!1,truckRouteType:!1,underlyingStreetCode:!1,uspsPreferredCityName:!1,workAreaFormatIndicatorIn:!1,xCoordActualSegmentHighAddressEnd:!1,xCoordActualSegmentLowAddressEnd:!1,xCoordinate:!1,xCoordinateHighAddressEnd:!1,xCoordinateLowAddressEnd:!1,xCoordinateOfCenterofCurvature:!1,yCoordActualSegmentHighAddressEnd:!1,yCoordActualSegmentLowAddressEnd:!1,yCoordinate:!1,yCoordinateHighAddressEnd:!1,yCoordinateLowAddressEnd:!1,yCoordinateOfCenterofCurvature:!1,zipCode:!1},pe={borough:"firstBoroughName",city:"uspsPreferredCityName",zip:"zipCode"};function ue(e){var t;const o={},n=this.getProperties();if(Object.keys(n).forEach((e=>{"geometry"!==e&&"__"!==e.substring(0,2)&&(o[e]=this.get(e),console.warn(e,this.get(e)))})),e){const a=(null==(t=this.get("__geocode"))?void 0:t.data)||{};Object.entries(e).forEach((e=>{e[1]&&!(e[0]in n)&&(o[e[0]]=a[e[0]])}))}return o}class he extends Q{constructor(e){super(e),this.geocode=e.geocode,this.locationTemplate=e.locationTemplate,this.featureCount=void 0,this.geocodedCount=0,this.notGeocoded=[]}writeFeatures(e,t){const o=[];return e.forEach((e=>{o.push(e.getCsvRow(t.append))})),d.unparse(o,{header:!0})}readFeatures(e,t){const o=super.readFeatures(e,t);return this.featureCount=(this.featureCount||0)+o.length,o}setGeocode(e,t){const o=e.get("__input"),n=e.get("__props");if(e.set("__geocode",t),"geocode"===t.type){const a=new c(t.coordinate).transform("EPSG:3857","EPSG:4326").getCoordinates(),s=t.data;console.info("Geocoded:",o,n,"geocode response:",t),e.setGeometry(new c(t.coordinate)),e.set("longitude",a[0]),e.set("latitude",a[1]),Object.keys(this.templateColumns).forEach((t=>{const o=this.templateColumns[t],n="address"===t?function(e){return`${e.houseNumber||""} ${e.firstStreetNameNormalized}`.trim()}(s):s[pe[t]];e.set(o,n)})),e.dispatchEvent("geocode",{target:e})}else console.warn("Ambiguous location:",o,n,"geocode response:",t),e.dispatchEvent("ambiguous",{target:e});e.dispatchEvent("change",{target:e})}createTemplate(e){this.templateColumns=e,this.locationTemplate=`\${${e.address}},\${${e.city||e.borough}}`,e.zip&&(this.locationTemplate=`${this.locationTemplate} \${${e.zip}}`),this.notGeocoded.forEach((e=>{this.geocodeFeature(e)}))}setGeometry(t,o,n){super.setGeometry(t,o,n),t.set("__format",this);const a=t.getGeometry().getCoordinates();this.mustGeocode=isNaN(a[0])||isNaN(a[1]),this.mustGeocode&&(this.locationTemplate?this.geocodeFeature(t):(this.notGeocoded.push(t),this.showDialog||(this.showDialog=!0,setTimeout((()=>{!function(t,o){oe=o,re.attr("data-i18n","geocode.csv"),se.find("select").each(((o,n)=>{e(n).empty().append(`<option value="0" data-i18n="csv.${n.name}"></option>`).append('<option value="0" data-i18n="csv.none"></option>'),Object.keys(t).forEach((t=>{"undefined"!==t&&e(n).append(`<option>${t}</option>`)}))})),le(se)}(o,this.createTemplate.bind(this))}),1e3))))}geocodeFeature(e){let t=!1;const o=e.getProperties(),n=W(this.locationTemplate,o);e.getCsvRow=ue.bind(e),e.set("__input",n),e.set("__props",o),e.set("__geocode",void 0),e.set("longitude",void 0),e.set("latitude",void 0),""===n.replace(/\,/g,"").trim()?(e.dispatchEvent({type:"change",target:e}),console.error("Invalid location:",n,"Bad record:",o)):this.geocode.locate(n).then((o=>{this.setGeocode(e,o),t=!0})).catch((e=>{console.error("Geocoding error:",n,o,"geocode response:",e)})).finally((()=>{t&&e.dispatchEvent({type:"change",target:e}),this.geocodedCount=this.geocodedCount+1,this.geocodedCount,this.featureCount}))}}class me{locate(){throw"Not implemented"}}me.Accuracy={HIGH:0,MEDIUM:50,LOW:500,ZIP_CODE:1e3};const ge={10001:[-8237898.254855099,4975874.394474808],10002:[-8236039.269729937,4970556.080729121],10003:[-8236350.999287944,4972729.990500424],10004:[-8242328.93440008,4967927.492131233],10005:[-8238811.124711711,4969293.248103004],10006:[-8239122.71478345,4969395.988627543],10007:[-8238343.433977984,4970306.659486939],10009:[-8235315.687385431,4972083.878043355],10010:[-8235738.646277056,4973920.234535434],10011:[-8238232.473252688,4974787.041884582],10012:[-8237408.57468438,4971936.993322589],10013:[-8238187.678036985,4971158.477580019],10014:[-8238365.730065603,4973156.250501537],10016:[-8235215.413517186,4974787.159931811],10017:[-8234581.143179877,4975830.355141334],10018:[-8237631.067765237,4976741.208255742],10019:[-8235471.5154924905,4977534.8356323745],10020:[-8235327.015647692,4976829.674782545],10021:[-8232510.324632227,4978196.53989793],10022:[-8234091.426533843,4976785.33374068],10023:[-8235827.61466049,4979387.116860526],10024:[-8234748.034258523,4980754.3476545485],10025:[-8233991.216928904,4982592.375460563],10026:[-8232443.701700113,4983327.483211856],10027:[-8231675.547848541,4984253.848261409],10028:[-8232955.685485609,4979710.559976443],10029:[-8231330.629917132,4981592.524737938],10030:[-8231230.35838697,4985533.718013053],10031:[-8232076.371035768,4986548.468361476],10032:[-8231152.308005255,4988608.570070782],10033:[-8230618.132406407,4990168.427597254],10034:[-8229003.975332391,4992729.135224446],10035:[-8228658.87972409,4981960.099675066],10036:[-8237174.977731553,4977270.436544006],10037:[-8230640.44163381,4984857.081561508],10038:[-8237976.3885189565,4969601.664933239],10039:[-8230696.169653147,4986798.730232556],10040:[-8229749.6007318115,4991433.7349681305],10041:[-8238655.270587629,4968647.167885807],10043:[-8238410.376155064,4968808.81156193],10044:[-8232766.476839592,4976271.276288124],10045:[-8238599.538529997,4969410.564901825],10047:[-8236117.041764534,4973978.773853874],10048:[-8239022.807284155,4969895.423111773],10055:[-8234703.377833344,4976858.952651859],10065:[-8233456.592832441,4977623.329365147],10069:[-8236518.136770003,4979298.859337928],10075:[-8233200.694417243,4979210.758150999],10080:[-8239033.627906033,4969748.293665161],10081:[-8238610.770876056,4969307.780622829],10096:[-8235705.250157594,4976227.131350288],10097:[-8235950.159003033,4977314.673902788],10103:[-8235048.4940912,4977049.850480667],10104:[-8235282.3566218205,4977064.8353914935],10105:[-8235304.768018202,4977446.854946064],10106:[-8235482.718659803,4977755.503365071],10107:[-8235694.065248632,4977917.318573731],10110:[-8235538.529271566,4976109.3186058225],10111:[-8235137.745860785,4976873.595971923],10112:[-8235438.300764235,4976917.637159328],10115:[-8233601.246487805,4984474.444808425],10118:[-8236050.545292822,4975301.14145487],10119:[-8236852.0198719995,4975756.591844015],10120:[-8236440.2273002835,4975506.889825814],10121:[-8236762.846076402,4975521.8473368175],10122:[-8236718.223355812,4975800.946734541],10123:[-8236606.936362911,4975742.048845656],10128:[-8232209.774753117,4980269.027085401],10151:[-8234647.737322354,4977476.122992346],10152:[-8234536.648775613,4976770.964808477],10153:[-8234569.760066431,4977534.995658932],10154:[-8234570.032276665,4976667.712169586],10155:[-8234068.7904111575,4977152.806721643],10158:[-8234859.3057438815,4975374.679958792],10162:[-8232221.2515222505,4978417.062934834],10165:[-8235282.2488860125,4975845.070883111],10166:[-8235037.508679332,4976050.712012682],10167:[-8234826.120176825,4976212.3955958355],10168:[-8235037.598617393,4975712.714930467],10169:[-8234981.627852579,4976168.070886193],10170:[-8234948.3475257745,4975918.391504809],10171:[-8234758.959409917,4976418.087229963],10172:[-8234770.244531843,4976300.310223679],10173:[-8235315.939272727,4976094.747360869],10174:[-8234892.540597895,4975771.561441211],10175:[-8235393.475150804,4976138.730491961],10176:[-8235282.533797546,4976329.893140122],10177:[-8234959.496813609,4976285.8435690515],10178:[-8235159.753744345,4975653.860778656],10196:[-8235549.691532641,4976520.743675165],10203:[-8238922.340122562,4969263.810124306],10259:[-8238755.332703016,4969454.886466689],10260:[-8238577.425563499,4969102.220771428],10265:[-8238521.601784703,4968941.003006705],10270:[-8238521.621552313,4969161.073026678],10271:[-8238811.136984007,4969396.031115972],10275:[-8239200.952284344,4969028.783952114],10278:[-8238098.893064653,4970438.8950092625],10279:[-8238566.269342897,4970012.778069716],10280:[-8239545.911699786,4969381.404303959],10281:[-8239334.418745888,4969998.163116765],10282:[-8239356.606434371,4970585.489549066],10285:[-8239289.877178382,4970174.3258885415],10286:[-8238655.320720752,4969131.636438197],10301:[-8246937.377286491,4959591.376034927],10302:[-8253004.225383037,4958036.326805039],10303:[-8257868.937045216,4958784.349820532],10304:[-8246380.816833891,4956657.651689616],10305:[-8246035.848565292,4952786.560420572],10306:[-8250989.412513622,4948389.45242114],10307:[-8264603.9630518695,4940025.586743551],10308:[-8254284.513864384,4946323.627484109],10309:[-8261932.382766553,4943466.861674528],10310:[-8251145.2088833265,4958227.109298989],10312:[-8257134.428636946,4945034.403472534],10314:[-8255676.120575744,4952639.85222197],10451:[-8229148.730221032,4985931.016910717],10452:[-8229115.180783189,4988431.722341746],10453:[-8228024.447548552,4990580.235020182],10454:[-8228313.847596413,4983739.348213179],10455:[-8228135.44952092,4985254.225299473],10456:[-8228135.6057075355,4987578.319540177],10457:[-8226321.055821567,4989608.992119663],10458:[-8225051.994504307,4992155.154718314],10459:[-8225742.453708348,4986651.793680155],10460:[-8225219.011122857,4988034.581167144],10461:[-8219920.154870781,4989800.163266178],10462:[-8222981.561530893,4990418.417495931],10463:[-8228224.881773997,4994716.830292753],10464:[-8216758.713390791,4994009.965197922],10465:[-8218639.930261247,4986239.552021528],10466:[-8221512.021374958,4996306.786868749],10467:[-8223337.775563561,4994201.294868081],10468:[-8225708.673988959,4993907.092645493],10469:[-8220565.724906521,4992920.385947198],10470:[-8221333.9110380495,4998089.0593251055],10471:[-8226231.965744965,4997352.664776363],10472:[-8222680.96774069,4987269.399567696],10473:[-8222269.041648097,4985489.351952049],10474:[-8223883.3198237065,4984107.0713562975],10475:[-8219029.64458401,4994083.680006887],11001:[-8205003.3380782325,4973111.926089625],11004:[-8204958.970512372,4974610.684987182],11005:[-8205281.941486081,4976197.6226715455],11040:[-8204814.076581695,4975889.105921043],11096:[-8209589.937431006,4955220.290951693],11101:[-8230784.932774079,4974933.858891035],11102:[-8229449.195740478,4978696.323131932],11103:[-8227979.907618949,4977417.319637209],11104:[-8228814.5452929465,4974742.719264442],11105:[-8226554.885951711,4979254.669873311],11106:[-8230751.75567312,4977549.577280225],11109:[-8232900.177392091,4974816.552597611],11201:[-8236551.224141984,4967325.672732009],11203:[-8230317.443977074,4960794.306808891],11204:[-8236183.963137048,4956217.467146712],11205:[-8232966.829742713,4967325.81774426],11206:[-8231230.283607679,4968470.991720706],11207:[-8225886.831683141,4963920.001057219],11208:[-8223415.871248527,4964330.834233442],11209:[-8240881.522693343,4956540.277159083],11210:[-8231686.587844869,4957552.25639282],11211:[-8231375.172081226,4970423.984311303],11212:[-8227957.478455588,4962731.132633065],11213:[-8231208.088507963,4963758.6079685725],11214:[-8237742.541485445,4954106.1052422095],11215:[-8235382.414740064,4963142.132121483],11216:[-8231998.512139418,4965343.606419273],11217:[-8235516.295407939,4965637.528352564],11218:[-8235015.336291092,4959870.094577763],11219:[-8237274.947254021,4958241.721595756],11220:[-8239579.272214988,4959415.234554172],11221:[-8229538.288023614,4967208.308449669],11222:[-8231809.316737498,4972348.106246132],11223:[-8234670.022522053,4953079.863065216],11224:[-8237619.87824402,4949986.697978471],11225:[-8232388.005752843,4962760.721704321],11226:[-8233044.819953497,4960251.516060097],11228:[-8238989.1742479885,4956012.19270536],11229:[-8231442.004546806,4953680.760121277],11230:[-8233935.453799772,4956819.079554566],11231:[-8238121.111065461,4964932.665782555],11232:[-8237898.281616303,4961542.530999506],11233:[-8228703.361655601,4964962.004509762],11234:[-8229593.759369582,4955895.037320518],11235:[-8230940.805486815,4950323.916852519],11236:[-8226655.182176102,4959385.859289364],11237:[-8229471.504235909,4969308.020011306],11238:[-8233612.455779487,4965079.7035464635],11239:[-8222669.67166009,4960764.990309578],11249:[-8233846.215741792,4969792.394320024],11251:[-8233957.597337317,4968309.584349321],11354:[-8218373.102979302,4978152.156787915],11355:[-8217749.5235936735,4975712.861390565],11356:[-8220009.442254614,4980666.1383847],11357:[-8216625.12310126,4980872.070220266],11358:[-8214955.239154878,4977064.848544981],11359:[-8212806.7952993885,4981754.121041791],11360:[-8213229.850713642,4980092.586883085],11361:[-8212105.585022557,4977623.340162408],11362:[-8208109.452872377,4976579.7393234335],11363:[-8209189.090081742,4978666.578614374],11364:[-8210602.747394159,4975257.184434445],11365:[-8214699.375257985,4973934.862010169],11366:[-8215456.297194507,4971937.059861935],11367:[-8218306.026242293,4972641.882184832],11368:[-8221322.743476162,4975345.237049506],11369:[-8223293.2631377475,4977623.314846329],11370:[-8224573.521526862,4981577.712556202],11371:[-8222469.357849653,4978725.44944083],11372:[-8224673.680359749,4975771.360191337],11373:[-8224105.753844719,4973890.8262391],11374:[-8222324.758527558,4971995.475107751],11375:[-8220521.2171715675,4971217.180017148],11377:[-8227066.940026556,4974786.949169431],11378:[-8227445.359597896,4971334.557554232],11379:[-8224317.27241099,4970776.451498717],11385:[-8226755.30580557,4968544.390005775],11411:[-8208131.561347233,4967384.474538301],11412:[-8210936.684213708,4967722.244987844],11413:[-8209901.420359371,4963729.183465719],11414:[-8220387.8886881545,4961880.026758593],11415:[-8218550.909958765,4969410.795215642],11416:[-8220966.856687647,4965872.051856082],11417:[-8220321.091011614,4964712.567854388],11418:[-8218874.046279643,4967780.721844535],11419:[-8217927.555589046,4966518.32005],11420:[-8216513.790424826,4964301.755855537],11421:[-8221734.949887653,4966943.981521459],11422:[-8208342.905348454,4962628.532842612],11423:[-8211716.0354445875,4970703.019412838],11426:[-8206918.332972859,4973552.860045781],11427:[-8209879.421112985,4972480.331757973],11428:[-8208966.221261969,4971334.671830668],11429:[-8208487.683182669,4969660.301322935],11430:[-8213831.264915304,4960412.69037466],11432:[-8214599.007994185,4970497.437342352],11433:[-8213908.927565444,4967927.436682986],11434:[-8212628.637559757,4964800.554705557],11435:[-8216480.331557604,4968456.101982255],11436:[-8214988.834648871,4964639.149334964],11451:[-8215300.682448109,4968324.086906612],11691:[-8209767.827392018,4953856.839641891],11692:[-8214877.369192967,4952522.478946348],11693:[-8216658.526231325,4951643.294451554],11694:[-8221100.362885608,4950060.310195802],11697:[-8227634.681636076,4947627.677967887],"00083":[-8234692.354700926,4978769.53155291]};class fe extends me{constructor(e){super(e),this.url=e.url}locate(e){return this.lastInput=e,new Promise(((t,o)=>{5!==(null==e?void 0:e.length)||isNaN(e)||this.geocodeZip(e,t,o);const n=encodeURIComponent(e.replace(/"/g,"").replace(/'/g,"").replace(/&/g," and "));this.callGeoclient(n,t,o)}))}geocodeZip(e){const t=ge[e];this.isMappable(t)?resolve({coordinate:t,accuracy:me.Accuracy.ZIP_CODE,type:"geocode",name:input}):reject({message:`Unkown ZIP Code ${input}`})}callGeoclient(e,t,o){fetch(`${this.url}${e}`).then((e=>{if(200===e.status)e.json().then((e=>{const n=this.handleResponse(e);n.error?o(n):t(n)}));else{const t=e.error;t.status=e.status,o({input:input,error:t})}}))}handleResponse(e){const t=e.results;if("OK"===e.status){const o=this.parse(t[0]);return 1===t.length&&this.isMappable(o.coordinate)?(o.type="geocode",o):{type:"ambiguous",input:e.input,possible:this.possible(t)}}return{error:e}}possible(e){const t=[];return e.forEach((e=>{t.push(this.parse(e))})),t}parse(e){const t=e.request.split(" ")[0],o=e.response;let n,a,s;if("intersection"===t)n=`${o.streetName1} and ${o.streetName2}`,a=[1*o.xCoordinate,1*o.yCoordinate],s=me.Accuracy.MEDIUM;else if("blockface"===t)n=o.firstStreetNameNormalized+" btwn "+o.secondStreetNameNormalized+" & "+o.thirdStreetNameNormalized,a=[(1*o.fromXCoordinate+1*o.toXCoordinate)/2,(1*o.fromYCoordinate+1*o.toYCoordinate)/2],s=me.Accuracy.LOW;else{const e=o.internalLabelXCoordinate,t=o.internalLabelYCoordinate;n=(o.houseNumber?o.houseNumber+" ":"")+(o.firstStreetNameNormalized||o.giStreetName1),a=[1*(e&&t?e:o.xCoordinate),1*(e&&t?t:o.yCoordinate)],s=e&&t?me.Accuracy.HIGH:me.Accuracy.MEDIUM}if(!this.isMappable(a)){const e=o;return e.message="No coordinate",{error:e}}try{const e=function(e){const t=e.split(" ");let o="";return t.forEach((e=>{const t=e.toLowerCase();o+=t.substring(0,1).toUpperCase(),o+=t.substring(1).toLowerCase(),o+=" "})),o.trim()}(`${n.replace(/  +/g," ")}, ${H[o.firstBoroughName]}`),t=`${e}, ${`NY ${o.zipCode||o.leftSegmentZipCode||""}`}`;return{type:"geocode",coordinate:Z("EPSG:2263","EPSG:3857",a),data:o,accuracy:s,name:t}}catch(i){const e=o;return e.message="Bad coordinate",{error:e}}}isMappable(e){return e&&!isNaN(e[0])&&!isNaN(e[1])}}const be={BASE_URL:"./",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_APP_DESC:"Another NYC Map",VITE_APP_THEME_COLOR:"#000000",VITE_APP_TITLE:"Another NYC Map",VITE_APP_TWITTER:"@nycTK",VITE_APP_URL:"http://localhost:5174",VITE_GENERIC_FILL_COLOR:"rgba(0,0,0,.25)",VITE_GENERIC_STROKE_COLOR:"rgba(0,0,0,.5)",VITE_GENERIC_STROKE_WIDTH:"2",VITE_GEOCLIENT_URL:"https://maps.nyc.gov/geoclient/v2/search.json?app_id=nyc-lib-example&app_key=74DF5DB1D7320A9A2&input=",VITE_NY_SENATE_KEY:"Ubzpyc4KA2KMXLHthS1FOTqlux3U7dGy",VITE_SITE_NAME:"timkeane.github.io",VITE_TILE_HOSTS:"maps{1-4}.nyc.gov"},Ee=new p({color:be.VITE_GENERIC_FILL_COLOR}),ye=new u({color:be.VITE_GENERIC_STROKE_COLOR,width:be.VITE_GENERIC_STROKE_WIDTH}),ve=[new h({image:new m({fill:Ee,stroke:ye,radius:10}),fill:Ee,stroke:ye})],_e={BASE_URL:"./",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_APP_DESC:"Another NYC Map",VITE_APP_THEME_COLOR:"#000000",VITE_APP_TITLE:"Another NYC Map",VITE_APP_TWITTER:"@nycTK",VITE_APP_URL:"http://localhost:5174",VITE_GENERIC_FILL_COLOR:"rgba(0,0,0,.25)",VITE_GENERIC_STROKE_COLOR:"rgba(0,0,0,.5)",VITE_GENERIC_STROKE_WIDTH:"2",VITE_GEOCLIENT_URL:"https://maps.nyc.gov/geoclient/v2/search.json?app_id=nyc-lib-example&app_key=74DF5DB1D7320A9A2&input=",VITE_NY_SENATE_KEY:"Ubzpyc4KA2KMXLHthS1FOTqlux3U7dGy",VITE_SITE_NAME:"timkeane.github.io",VITE_TILE_HOSTS:"maps{1-4}.nyc.gov"},Te=new fe({url:_e.VITE_GEOCLIENT_URL,appId:_e.VITE_GEOCLIENT_ID,appKey:_e.VITE_GEOCLIENT_KEY});let Se;const Ce={canDownload:()=>"download"in e("<a></a>").get(0),saveCsv(t,o){const n=`data:application/csv;charset=utf-8,${encodeURIComponent(o)}`,a=e('<a class="file-dwn"><img></a>');e("body").append(a),a.attr({href:n,download:t}).find("img").trigger("click"),a.remove()},saveGeoJson(t,o){const n=`data:application/json;charset=utf-8,${encodeURIComponent(o)}`,a=e('<a class="file-dwn"><img></a>');e("body").append(a),a.attr({href:n,download:t}).find("img").trigger("click"),a.remove()},setItem(e,t){"localStorage"in window&&localStorage.setItem(e,t)},getItem(e){if("localStorage"in window)return localStorage.getItem(e)},removeItem(e){"localStorage"in window&&localStorage.removeItem(e)},readTextFile(t,o){const n=new FileReader;if(n.onload=()=>{t(n.result)},o)n.readAsText(o);else{const t=e('<input class="file-in" type="file">');e("body").append(t),t.change((e=>{t.remove(),n.readAsText(e.target.files[0])})),t.trigger("click")}},loadGeoJsonFile(e,t,o){this.readTextFile((n=>{const a=this.addToMap(e,n,o.name);t&&t(a)}),o)},loadCsvFile(e,t,o){this.readTextFile((n=>{const a=this.addToMap(e,n,o.name);t&&t(a)}),o)},loadShapeFile(t,o,n){if(n)this.getShpDbfPrj(t,n,o);else{const n=this,a=e('<input class="file-in" type="file" multiple>');e("body").append(a),a.change((e=>{n.getShpDbfPrj(t,e.target.files,o),a.remove()})),a.trigger("click")}},getShpDbfPrj(e,t,o){let n,a,s;Object.values(t).forEach((e=>{const t=e.name,o=t.substring(t.length-4).toLowerCase();".shp"===o?(n=e,Se=e):".dbf"===o?a=e:".prj"===o&&(s=e)})),n?this.readPrj(s,(t=>{this.readShpDbf(e,n,a,t,o)})):o&&o()},readPrj(e,t){e?this.readTextFile(t,e):t()},readShpDbf(e,t,o,n,a){let s,i;const r=new FileReader;r.onload=t=>{s=t.target.result,!i&&o||this.readShp(e,s,i,n,a)};const l=new FileReader;l.onload=t=>{i=t.target.result,s&&this.readShp(e,s,i,n,a)},r.readAsArrayBuffer(t),o&&l.readAsArrayBuffer(o)},readShp(e,t,o,n,a){const s=this,i=[];shapefile.open(t,o).then((t=>{t.read().then((function o(r){if(!r.done)return i.push(r.value),t.read().then(o);{const t=s.addToMap(e,i,Se.name,n);a&&a(t)}}))})).catch((e=>{console.error(e)}))},addToMap(e,t,o,n){const a=null==o?void 0:o.substring(o.lastIndexOf(".")),s={featureProjection:e.getView().getProjection().getCode(),dataProjection:J(n),geocode:Te},i=".csv"===a?new he(s):new g;".shp"===a&&(t={type:"FeatureCollection",features:t});const r=new f({format:i}),l=new b({source:r,style:ve});return!l.get("name")&&o&&l.set("file",o),r.addFeatures(i.readFeatures(t,s)),e.addLayer(l),l}};class Ie extends E{constructor(t){const o=e(t.map.getTargetElement()).find(".feature-tip").get(0);super({id:q("tip"),element:o||e('<div class="feature-tip" role="tooltip"></div>').get(0),offset:[5,5],className:"overlay-1 ol ol-overlay-container ol-selectable"}),this.setMap(t.map),this.map=this.getMap(),this.tip=e(this.getElement()),this.map.on("pointermove",this.label.bind(this))}hide(){this.tip.fadeOut((()=>{this.setPosition(void 0)}))}out(t){e.contains(this.map.getTargetElement(),t.target)||this.hide()}label(e){const t=this.map.forEachFeatureAtPixel(e.pixel,((e,t)=>{const o=t.get("tip")||Le;return t.getVisible()?o(e):null}));t?(this.tip.html(t.html).localize(),this.tip.get(0).className=`feature-tip ${t.css||""}`,this.setPosition(e.coordinate),this.tip.show(),this.position()):this.hide()}position(){const e=this.map.getSize(),t=this.tip.width(),o=this.tip.height(),n=this.map.getPixelFromCoordinate(this.getPosition()),a=n[1]+o>e[1]?"bottom":"top",s=n[0]+t>e[0]?"right":"left";this.tip.attr("data-pos",`${a}-${s}`),this.setPositioning(`${a}-${s}`)}}function Le(t){const o=t.getProperties();let n=Object.keys(o)[1];return n=Object.keys(o).find((e=>{if(e.toLowerCase().indexOf("name")>-1||e.toLowerCase().indexOf("label")>-1||e.toLowerCase().indexOf("lbl")>-1||e.toLowerCase().indexOf("addr")>-1)return e})),{html:e(`<div><strong>${n}:</strong> ${o[n]}</div>`)}}const we={BASE_URL:"./",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_APP_DESC:"Another NYC Map",VITE_APP_THEME_COLOR:"#000000",VITE_APP_TITLE:"Another NYC Map",VITE_APP_TWITTER:"@nycTK",VITE_APP_URL:"http://localhost:5174",VITE_GENERIC_FILL_COLOR:"rgba(0,0,0,.25)",VITE_GENERIC_STROKE_COLOR:"rgba(0,0,0,.5)",VITE_GENERIC_STROKE_WIDTH:"2",VITE_GEOCLIENT_URL:"https://maps.nyc.gov/geoclient/v2/search.json?app_id=nyc-lib-example&app_key=74DF5DB1D7320A9A2&input=",VITE_NY_SENATE_KEY:"Ubzpyc4KA2KMXLHthS1FOTqlux3U7dGy",VITE_SITE_NAME:"timkeane.github.io",VITE_TILE_HOSTS:"maps{1-4}.nyc.gov"},Oe={layer:{sirLine:"https://services5.arcgis.com/GfwWNkhOj9bNBqoJ/ArcGIS/rest/services/Subway/FeatureServer/0/query?f=pgeojson&outFields=*&where=NAME%3D'Staten%20Island%20Rwy'",subwayLine:"https://data.cityofnewyork.us/api/geospatial/3qz8-muuu?method=export&format=GeoJSON",subwayStation:"https://data.ny.gov/api/views/39hk-dx4f/rows.geojson?accessType=DOWNLOAD"},info:{pluto:{intersect:"https://services5.arcgis.com/GfwWNkhOj9bNBqoJ/arcgis/rest/services/MAPPLUTO/FeatureServer/0/query?f=geojson&where=1%3D1&spatialRel=esriSpatialRelIntersects&outFields=*&outSR=3857&inSR=3857&geometryType=esriGeometryPoint&geometry=",bbl:"https://services5.arcgis.com/GfwWNkhOj9bNBqoJ/arcgis/rest/services/MAPPLUTO/FeatureServer/0/query?f=geojson&spatialRel=esriSpatialRelIntersects&outFields=*&outSR=3857&where=BBL%3D"},subwayLine:"https://new.mta.info/maps/subway-line-maps/${subway}-line",sirLine:"https://new.mta.info/agency/staten-island-railway"},zone:{map:"https://s-media.nyc.gov/agencies/dcp/assets/files/pdf/zoning/zoning-maps/map${0}.pdf",district:"https://www.nyc.gov/site/planning/zoning/districts-tools/${0}.page",special:"https://www.nyc.gov/site/planning/zoning/districts-tools/special-purpose-districts.page"},district:{community:"https://www.nyc.gov/site/${boro}cb${board}/index.page"},political:{service:{city:"https://nyc-council.carto.com/api/v2/sql?q=SELECT%20coundist%20as%20district,%20council_member%20as%20member%20FROM%20council_districts_post_2024",state:`https://legislation.nysenate.gov/api/3/members/${(new Date).getFullYear()}?full=true&limit=1000&key=${we.VITE_NY_SENATE_KEY}`,federal:"https://www.govtrack.us/api/v2/role?current=true&state=NY"},person:{city:"https://council.nyc.gov/district-${district}",state:{assembly:"https://nyassembly.gov/mem/${name}",senate:"https://www.nysenate.gov/senators/${name}"},federal:{house:"https://${name}.house.gov/",senate:"https://${name}.senate.gov/"}},pollsite:"https://findmypollsite.vote.nyc/?hn=${houseNumber}&sn=${streetName1In}&zip=${zipCode}"}};function Ne(e,t,o){return`<a href="${W(e,o||{})}" target="_blank" rel="noopener">${t}</a>`}const $e={};fetch(Oe.political.service.city).then((e=>e.json().then((e=>{const t={};e.rows.forEach((e=>{const o=e.district;t[o]={title:"title.council",name:e.member}})),$e.city=t})))),fetch(Oe.political.service.state).then((e=>e.json().then((e=>{const t={},o={};e.result.items.forEach((e=>{const n=e.districtCode,a={name:e.fullName};"ASSEMBLY"===e.chamber?(a.title="title.assembly",o[n]=a):(a.title="title.senator",t[n]=a)})),$e.state={assembly:o},$e.state.senate=t})))),fetch(Oe.political.service.federal).then((e=>e.json().then((e=>{const t={},o={};e.objects.forEach((e=>{const n=e.person.lastname,a={lastname:n,name:`${e.person.firstname} ${n}`};"senator"===e.role_type?(a.title=`title.${e.senator_rank_label.toLowerCase()}.${e.role_type_label.toLowerCase()}`,o[e.senator_rank]=a):(a.title=`title.${e.role_type_label.toLowerCase()}`,t[e.district]=a)})),$e.federal={house:t},$e.federal.senate=o}))));const Pe={jurisdictions:{city:"city",state:{assembly:"state.assembly",senate:"state.senate"},federal:{house:"federal.house",senate:"federal.senate"}},officials:$e};function Ae(e){const t=[];return e.forEach((e=>{e&&t.push(e)})),t}function Re(t){const o=t.ZoneMap,n=Ne(Oe.zone.map,`${o}`,[o]),a=e('<h3 data-i18n="zoning"></h3>'),s=e(`<ul><li><strong data-i18n="[prepend]map">:</strong> ${n}</li></ul>`),i=function(e,t){const o=[];return Ae(e).forEach((e=>{const n=Ne(Oe.zone[t],e,[e.split("-")[0].toLowerCase()]);o.push(n)})),o.join(", ")}([t.ZoneDist1,t.ZoneDist2,t.ZoneDist3,t.ZoneDist4],"district");s.append(`<li><strong data-i18n="[prepend]district">:</strong> ${i}</li>`);const r=Ae([t.Overlay1,t.Overlay2]).join(", ");s.append(r?`<li><strong data-i18n="[prepend]overlay">:</strong> ${r}</li>`:"");const l=Ae([t.SPDist1,t.SPDist2,t.SPDist3]).join(", ");return s.append(l?`<li><strong data-i18n="[prepend]special">:</strong> ${l}</li>`:""),e("<div></div>").append(a).append(s).html()}function ke(t,o,n){let a,s;t.forEach((e=>{a=(a||Pe.officials)[e],s=(s||Pe.jurisdictions)[e]}));const i=a[o],r=t.join("-"),l=n.find(`.${r}`),c=1===l.length,d=i.name;let p;if(1==t.length)p=Ne(Oe.political.person[t[0]],` ${d}`,{district:o});else{const e=function(e,t,o){if("state"===t){let t=X(e.trim().replace(/ /g,"-"));return"senate"===o&&(t=t.toLowerCase()),t}return X(e.toLowerCase())}(i.lastname||d,t[0],t[1]);p=Ne(Oe.political.person[t[0]][t[1]],` ${d}`,{name:e})}const u=e(p);if(u.attr("data-i18n",`[prepend]${i.title}`),!c){const t=isNaN(o)?"":` <span data-i18n="[prepend]district"> ${o}</span>`;return e(`<li class="${r}"></li>`).append(`<strong><span data-i18n="jurisdiction.${s}"></span>${t}</strong><br>`).append(u)}l.append("<br>").append(u)}function De(t){const o=1*t.cityCouncilDistrict,n=1*t.assemblyDistrict,a=1*t.stateSenatorialDistrict,s=1*t.congressionalDistrict,i=e('<h3 data-i18n="elected.officials"></h3>'),r=e("<ul></ul>");return r.append(function(t){return e("<li></li>").append(`<strong data-i18n="[prepend]election.district"> ${t.electionDistrict}</strong><br>`).append(`<a href="${W(Oe.political.pollsite,t)}" target="_blank" rel="noopener" data-i18n="election.poll"></a>`)}(t)).append(ke(["city"],o,r)).append(ke(["state","assembly"],n,r)).append(ke(["state","senate"],a,r)).append(ke(["federal","house"],s,r)).append(ke(["federal","senate"],"senior",r)).append(ke(["federal","senate"],"junior",r)),e("<div></div>").append(i).append(r).html()}function Ve(e){return e.uspsPreferredCityName?`<address>${e.Address}<br>${e.uspsPreferredCityName}, NY ${e.zipCode}</address>`:`${e.Address}, ${U(e.Borough)}`}function xe(e){const t=e.getProperties(),o=`${t.BBL}`,n=o.substring(1,6),a=o.substring(6);return`${U(t.Borough)} Block: ${n} Lot: ${a}`}function Fe(t){const o=t.getProperties();return e('<div class="feature-html pluto"></div>').append(Ve(o)).append(function(e){return`<div><strong data-i18n="[prepend]owner">:</strong> ${e.OwnerName}</div>`}(o)).append(function(e){const t=U(e.Borough),o=1*e.communityDistrictNumber;return`<h3><a href="${W(Oe.district.community,{boro:t.toLowerCase(),board:o})}" target="_blank" rel="noopener">${t} <span data-i18n="community.board"></span> ${o}</a></h3>`}(o)).append(De(o)).append(Re(o))}class Be extends y{constructor(e){super(e),this.style=e.style}createRenderer(){return new v(this,{style:this.style})}}const je=new Be({source:new f,style:{"stroke-color":"red","stroke-width":3,"fill-color":"rgba(255,255,204,.3)"}});je.set("name","highlight"),je.set("tip",(function(e){const t=e.getProperties();return{html:`${xe(e)}<br>${Ve(t)}`}}));const Ge={BASE_URL:"./",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_APP_DESC:"Another NYC Map",VITE_APP_THEME_COLOR:"#000000",VITE_APP_TITLE:"Another NYC Map",VITE_APP_TWITTER:"@nycTK",VITE_APP_URL:"http://localhost:5174",VITE_GENERIC_FILL_COLOR:"rgba(0,0,0,.25)",VITE_GENERIC_STROKE_COLOR:"rgba(0,0,0,.5)",VITE_GENERIC_STROKE_WIDTH:"2",VITE_GEOCLIENT_URL:"https://maps.nyc.gov/geoclient/v2/search.json?app_id=nyc-lib-example&app_key=74DF5DB1D7320A9A2&input=",VITE_NY_SENATE_KEY:"Ubzpyc4KA2KMXLHthS1FOTqlux3U7dGy",VITE_SITE_NAME:"timkeane.github.io",VITE_TILE_HOSTS:"maps{1-4}.nyc.gov"},Me=new g,ze=je.getSource();function He(){ze.getFeatures().forEach((e=>{e.get("forSearch")&&ze.removeFeature(e)}))}function Ue(e){ze.removeFeature(e)}function Ke(e,t){He(),function(e){fetch(`${Oe.info.pluto.bbl}${e}`).then((e=>e.json().then((e=>{if(e.features.length>0){const t=Me.readFeature(e.features[0]);t.set("forSearch",!0),ze.addFeature(t)}}))))}(e)}function Ye(e,t){He(),function(e,t){fetch(`${Oe.info.pluto.intersect}${e.join()}`).then((e=>e.json().then((e=>{if(e.features.length>0){const o=Me.readFeature(e.features[0]);ze.addFeature(o),t&&t(o)}}))))}(e,t)}const qe=new g,We={};function Xe(t){const o=this.getMap();if(!o||!o.getTargetElement()||!this.getPosition())return;const n=this.getRect(o.getTargetElement(),o.getSize()),a=this.getElement(),s=this.getRect(a,[T(e(a).find(".popup-content").get(0)),S(a)]),i=void 0===(t=t||{}).margin?20:t.margin;if(!C(n,s)){const e=s[0]-n[0],a=n[2]-s[2],r=s[1]-n[1],l=n[3]-s[3],c=[0,0];if(e<0?c[0]=e-i:a<0&&(c[0]=Math.abs(a)+i),r<0?c[1]=r-i:l<0&&(c[1]=Math.abs(l)+i),0!==c[0]||0!==c[1]){const e=o.getView().getCenterInternal(),n=o.getPixelFromCoordinateInternal(e);if(!n)return;const a=[n[0]+c[0],n[1]+c[1]],s=t.animation||{};o.getView().animateInternal({center:o.getCoordinateFromPixelInternal(a),duration:s.duration,easing:s.easing})}}}function Ze(t){const o=e(t.target).data("instanceId"),n=We[o];n&&n.on&&(t.preventDefault(),n.pos1=n.pos3-t.clientX,n.pos2=n.pos4-t.clientY,n.pos3=t.clientX,n.pos4=t.clientY,n.dragElem.css({top:n.dragElem.get(0).offsetTop-n.pos2+"px",left:n.dragElem.get(0).offsetLeft-n.pos1+"px"}),Je(o))}function Je(e){const t=We[e],o=t.dragElem,n=o.find("path");if(t){const e=t.overlay.getMap(),a=t.overlay.getPosition(),s=e.getPixelFromCoordinate(a),i=function(e){const t=e.find(".popup"),o=t.get(0).getBoundingClientRect();return{ll:[o.left,o.bottom],lr:[o.right,o.bottom],ur:[o.right,o.top],ul:[o.left,o.top]}}(o),r=[];Object.keys(i).forEach((e=>{const t=new _([s,i[e]]).getLength();r.push({corner:e,length:t})})),r.sort(((e,t)=>e.length<t.length?-1:e.length>e.length?1:0)),function(e,t,o,n,a){const s=t.attr("d"),i=s.split(" "),r=Math.floor(o.lr[0]-o.ll[0]),l=Math.floor(o.ll[1]-o.ul[1]);let c,d;"ll"===a&&o.ll[1]<n[1]&&(c="M40 0",d="L20 0");"lr"===a&&o.ll[1]<n[1]&&(c=`M${r-19} 0`,d=`L${r-39} 0`);"ll"===a&&o.ll[1]>=n[1]&&(c="M1 -20",d="L1 -40");"lr"===a&&o.ll[1]>=n[1]&&(c=`M${r-1} -20`,d=`L${r-1} -40`);"ul"===a&&o.ul[1]<n[1]&&(c="M1 -"+(l-39),d="L1 -"+(l-19));"ur"===a&&o.ul[1]<n[1]&&(c=`M${r-1} -${l-39}`,d=`L${r-1} -${l-19}`);"ul"===a&&o.ul[1]>=n[1]&&(c="M20 -"+(l-2),d="L40 -"+(l-2));"ur"===a&&o.ul[1]>=n[1]&&(c=`M${r-19} -${l-2}`,d=`L${r-39} -${l-2}`);const p=`L${1*i[2].substring(1)+e.pos1} ${1*i[3]+e.pos2}`;t.attr("d",`${c} ${p} ${d}`)}(t,n,i,s,r[0].corner)}}function Qe(e){Object.values(We).forEach((e=>e.on=!1))}function et(t){const o=e(t.target).data("instanceId"),n=We[o];t.preventDefault(),n&&(n.on=!0,n.pos3=t.clientX,n.pos4=t.clientY,e(document).one("mouseup",Qe),e(document).on("mousemove",Ze))}class tt{constructor(t){const o=q("drag");this.overlay=t,this.dragElem=e(t.getElement()).parent().data("instanceId",o),this.dragHandle=e(t.getElement()).find("h2").data("instanceId",o),this.pos1=0,this.pos2=0,this.pos3=0,this.pos4=0,We[o]=this,this.dragHandle.on("mousedown",et)}}const ot=function(e){return"highlight"!==e.get("name")};function nt(t){var o;const n=t.getProperties(),a=e("<table><tbody></tbody></table>"),s=a.find("tbody");Object.entries(n).forEach((e=>{const t=e[0];if("__"!==t.substring(0,2)){const o=function(e,t){return"geometry"===e?qe.writeGeometry(t):"string"==typeof t&&0===t.indexOf("http")?`<a href="${t}" target="_blank">${t}</a>`:t}(t,e[1]);s.append(`<tr class="${t.replace(/ /g,"-")}"><td class="field">${t}</td><td class="value">${o}</td></tr>`)}}));const i=null==(o=t.get("__geocode"))?void 0:o.data;return i&&Object.entries(i).forEach((e=>{const t=e[0],o=e[1];s.append(`<tr class="geo ${t}"><td class="field">${t}</td><td class="value">${o}</td></tr>`)})),e('<div class="feature-html generic"></div>').append(a)}function at(e,t){return(t=t||nt)(e)}function st(t){e(".popup-overlay").each(((t,o)=>{e(o).parent().removeClass("active-popup")})),e(t.delegateTarget).parent().addClass("active-popup")}function it(t,o,n,a,s){const i=e('<div class="popup-overlay">\n  <div class="popup">\n    <a class="btn-close corner" href="#" aria-role="button"\n      data-i18n="[title]close;[aria-label]close">\n    </a>\n    <a class="btn-min min corner" href="#" aria-role="button"\n      data-i18n="[title]min;[aria-label]min">\n    </a>\n    <h2></h2>\n    <div class="popup-content"></div>\n  </div>\n  <svg>\n    <path d="M40 0 L30 10 L20 0"></path>\n  </svg>\n</div>'),r=i.find("h2");i.find(".popup").addClass(a.hasClass("pluto")?"min":""),r.attr("data-i18n",`layer.${n}`),i.find(".popup-content").html(a),i.localize(),""===r.html()&&r.html(n);const l=new E({element:i.get(0),autoPan:{animation:{duration:250}},className:"ol ol-overlay-container ol-selectable"});l.panIntoView=Xe.bind(l),l.highlight=s,t.addOverlay(l),new tt(l),i.parent().css("z-index",e(".popup-overlay").length),i.on("mousedown",st),l.setPosition(o),i.find(".btn-close").on("click",(()=>{i.fadeOut((()=>{Object.keys(We).forEach((e=>{We[e].overlay===l&&delete We[e]})),Ue(l.highlight),t.removeOverlay(l),i.remove()}))})),i.find(".btn-min").on("click",(t=>{const o=e(t.target),n=o.hasClass("min")?"max":"min";o.removeClass("min").removeClass("max").addClass(n).attr("data-i18n",`[title]${n};[aria-label]${n}`).localize(),i.find(".popup-content")["min"===n?"slideDown":"slideUp"]()}))}function rt(){Object.keys(We).forEach((e=>Je(e)))}function lt(e){const t=e.map,o=e.coordinate;t.forEachFeatureAtPixel(e.pixel,((e,n)=>{const a=n.get("name")||n.get("file")||"layer";return it(t,o,a,at(e,n.get("html"))),!0}),{layerFilter:ot})||Ye(o,(e=>function(e,t){let o=!1;const n=`${e.get("Address")}, ${e.get("Borough")}`;fetch(`${Ge.VITE_GEOCLIENT_URL}${encodeURIComponent(n)}`).then((n=>n.json().then((n=>{n.results.length>0&&(o=!0,Object.entries(n.results[0].response).forEach((t=>e.set(t[0],t[1])))),t({feature:e,embellished:o})}))))}(e,(e=>{const n=e.feature;e.embellished?it(t,o,xe(n),at(n,Fe),n):Ue(n)}))))}const ct={BASE_URL:"./",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_APP_DESC:"Another NYC Map",VITE_APP_THEME_COLOR:"#000000",VITE_APP_TITLE:"Another NYC Map",VITE_APP_TWITTER:"@nycTK",VITE_APP_URL:"http://localhost:5174",VITE_GENERIC_FILL_COLOR:"rgba(0,0,0,.25)",VITE_GENERIC_STROKE_COLOR:"rgba(0,0,0,.5)",VITE_GENERIC_STROKE_WIDTH:"2",VITE_GEOCLIENT_URL:"https://maps.nyc.gov/geoclient/v2/search.json?app_id=nyc-lib-example&app_key=74DF5DB1D7320A9A2&input=",VITE_NY_SENATE_KEY:"Ubzpyc4KA2KMXLHthS1FOTqlux3U7dGy",VITE_SITE_NAME:"timkeane.github.io",VITE_TILE_HOSTS:"maps{1-4}.nyc.gov"};class dt extends I{constructor(e){(e=e||{}).view=new L({center:dt.CENTER,minZoom:8,maxZoom:21,zoom:8,constrainRotation:1}),e.interactions||(e.interactions=[new w,new O,new N,new $,new P,new A,new R]),super(e),this.hasPhoto=!1,this.labels={},this.latestPhoto=0,this.photos={},this.base=new k({extent:dt.UNIVERSE_EXTENT,source:new D({url:dt.BASE_URL})}),this.addLayer(this.base),Object.entries(dt.LABEL_URLS).forEach((([e,t])=>{this.labels[e]=new k({extent:dt.LABEL_EXTENT,source:new D({url:t}),zIndex:1e3,visible:e===dt.LabelType.BASE}),this.addLayer(this.labels[e])})),this.setupPhotos(e),this.hookupEvents(this.getTargetElement()),this.defaultExtent(),this.setupExtras()}setupExtras(){e(".ol-zoom button").each(((t,o)=>{e(o).html(`<div>${e(o).html()}</div>`)}));const t=new V({units:"us",bar:!0,steps:4,text:!0,minWidth:140});this.addControl(t),e(this.getTargetElement()).find(".ol-scale-bar").prepend('<img class="north-arrow" alt="North" src="img/north.svg">')}getBaseLayers(){return{base:this.base,labels:this.labels,photos:this.photos}}setupPhotos(e){Object.entries(dt.PHOTO_URLS).forEach((([e,t])=>{const o=new k({extent:dt.PHOTO_EXTENT,source:new D({url:t}),visible:!1});1*e.split("-")[0]>this.latestPhoto&&(this.latestPhoto=e),o.set("name",e),this.addLayer(o),o.on("change:visible",this.photoChange.bind(this)),this.photos[e]=o}))}photoChange(){let e=!1;Object.entries(this.photos).some((([t,o])=>{if(e=o.getVisible(),e)return this.showLabels(dt.LabelType.PHOTO),!0})),e||this.showLabels(dt.LabelType.BASE)}showPhoto(e){this.hidePhoto(),this.hasPhoto=!0,this.photos[(e||this.latestPhoto)+""].setVisible(!0),this.showLabels(dt.LabelType.PHOTO)}hidePhoto(){this.hasPhoto=!1,this.showLabels(dt.LabelType.BASE),Object.entries(this.photos).forEach((([e,t])=>{t.setVisible(!1)}))}showLabels(e){this.labels.photo.setVisible(e===dt.LabelType.BASE),this.labels.photo.setVisible(e===dt.LabelType.PHOTO)}defaultExtent(){this.getView().fit(dt.EXTENT,this.getSize())}hookupEvents(t){new Ie({map:this}),this.on("singleclick",lt),e(t).on("drop",this.loadLayer.bind(this)),e(t).on("dragover",(e=>e.preventDefault()))}loadLayer(e){const t=e.originalEvent.dataTransfer;e.preventDefault(),t&&t.files.length&&this.loadFile(t.files)}loadUrl(e,t){fetch(e).then((e=>e.text().then((e=>{const o=Ce.addToMap(this,e);t&&t(o)}))))}loadFile(e,t){const o=e[0].name.split(".").pop().toLowerCase();"json"===o||"geojson"===o?Ce.loadGeoJsonFile(this,t,e[0]):"csv"===o?Ce.loadCsvFile(this,t,e[0]):Ce.loadShapeFile(this,t,e)}saveGeoJson(e,t){const o=new g({featureProjection:this.getView().getProjection(),dataProjection:"EPSG:4326"});Ce.saveGeoJson(t||"layer.geojson",o.writeFeatures(e.getFeatures()))}sortedPhotos(){const e=[];return Object.keys(this.photos).forEach((t=>{e.push(this.photos[t])})),e.sort(((e,t)=>{const o=e.name||e.get("name");return(t.name||t.get("name")).substr(0,4)-o.substr(0,4)}))}}dt.UNIVERSE_EXTENT=[-8453323,4774561,-7983695,5165920],dt.EXTENT=[-8266522,4937867,-8203781,5000276],dt.CENTER=[-8235252,4969073],dt.LABEL_EXTENT=[-8268e3,4870900,-8005e3,5055500],dt.PHOTO_EXTENT=[-8268357,4937238,-8203099,5001716],dt.BASE_URL=`https://${ct.VITE_TILE_HOSTS}/tms/1.0.0/carto/basemap/{z}/{x}/{-y}.jpg`,dt.PHOTO_URLS={1924:`https://${ct.VITE_TILE_HOSTS}/tms/1.0.0/photo/1924/{z}/{x}/{-y}.png8`,1951:`https://${ct.VITE_TILE_HOSTS}/tms/1.0.0/photo/1951/{z}/{x}/{-y}.png8`,1996:`https://${ct.VITE_TILE_HOSTS}/tms/1.0.0/photo/1996/{z}/{x}/{-y}.png8`,"2001-2":`https://${ct.VITE_TILE_HOSTS}/tms/1.0.0/photo/2001-2/{z}/{x}/{-y}.png8`,2004:`https://${ct.VITE_TILE_HOSTS}/tms/1.0.0/photo/2004/{z}/{x}/{-y}.png8`,2006:`https://${ct.VITE_TILE_HOSTS}/tms/1.0.0/photo/2006/{z}/{x}/{-y}.png8`,2008:`https://${ct.VITE_TILE_HOSTS}/tms/1.0.0/photo/2008/{z}/{x}/{-y}.png8`,2010:`https://${ct.VITE_TILE_HOSTS}/tms/1.0.0/photo/2010/{z}/{x}/{-y}.png8`,2012:`https://${ct.VITE_TILE_HOSTS}/tms/1.0.0/photo/2012/{z}/{x}/{-y}.png8`,2014:`https://${ct.VITE_TILE_HOSTS}/tms/1.0.0/photo/2014/{z}/{x}/{-y}.png8`,2016:`https://${ct.VITE_TILE_HOSTS}/tms/1.0.0/photo/2016/{z}/{x}/{-y}.png8`,2018:`https://${ct.VITE_TILE_HOSTS}/tms/1.0.0/photo/2018/{z}/{x}/{-y}.png8`,2020:"https://tiles.arcgis.com/tiles/yG5s3afENB5iO9fj/arcgis/rest/services/NYC_Orthos_-_2020/MapServer/tile/{z}/{y}/{x}",2022:"https://tiles.arcgis.com/tiles/yG5s3afENB5iO9fj/arcgis/rest/services/DO_NOT_USE_NYC_2022_Orthos_WMA/MapServer/tile/{z}/{y}/{x}"},dt.LABEL_URLS={base:`https://${ct.VITE_TILE_HOSTS}/tms/1.0.0/carto/label/{z}/{x}/{-y}.png8`,photo:`https://${ct.VITE_TILE_HOSTS}/tms/1.0.0/carto/label-lt/{z}/{x}/{-y}.png8`},dt.LabelType={BASE:"base",PHOTO:"photo"};class pt{constructor(t){const o=e('<form class="locate-form location" style="pointer-events: auto;">\n  <select name="type" class="form-control form-select btn type" data-i18n="[title]search.type;[aria-label]search.type">\n    <option value="location" data-i18n="[prepend]search.location">&nbsp;&nbsp;&nbsp;&nbsp;</option>\n    <option value="bbl" data-i18n="search.bbl"></option>\n  </select>\n  <input name="location" class="form-control location" data-i18n="[placeholder]placeholder.location" autocomplete="on">\n  <select name="boro" class="form-control form-select bbl boro" data-i18n="[title]boro;[aria-label]boro" autocomplete="on">\n    <option value="0" data-i18n="[prepend]boro">...</option>\n    <option value="2">Bronx</option>\n    <option value="3">Brooklyn</option>\n    <option value="1">Manhattan</option>\n    <option value="4">Queens</option>\n    <option value="5">Staten Island</option>\n  </select>\n  <input name="block" class="form-control bbl block" data-i18n="[placeholder]placeholder.block" autocomplete="on">\n  <input name="lot" class="form-control bbl lot" data-i18n="[placeholder]placeholder.lot" autocomplete="on">\n  <button class="btn btn-primary search" name="submit" data-i18n="[title]search;[aria-label]search"></button>\n  <div id="location"></div>\n  <ul class="list-group possible"></ul>\n</form>').localize();t.map,t.target&&e(t.target).append(o),o.on("submit ",this.search.bind(this)),o.on("keyup",this.search.bind(this)),this.searchType=o.find("select.type"),this.searchType.on("change",this.setSearchType.bind(this)),this.location=o.find(".location"),this.boro=o.find(".boro"),this.block=o.find(".block"),this.lot=o.find(".lot"),this.possible=o.find(".possible"),this.form=o,this.geocode=t.geocode,this.map=t.map,this.addControl()}addControl(){this.pinOverlay=new E({element:this.form.find("#location").get(0),offset:[-24,-48],className:"overlay-0 ol ol-overlay-container ol-selectable"}),this.map.addOverlay(this.pinOverlay),this.map.addControl(new n({element:this.form.get(0)}))}val(){return this.location.is(":visible")?this.location.val():this.bbl()}bbl(){const e=this.boro.val();if("0"!==e){const t=K(this.block.val(),5),o=K(this.lot.val(),4);return this.block.val(t),this.lot.val(o),`${e}${t}${o}`}return""}search(t){if(t.preventDefault(),!t.key||"Enter"===t.key){const t=this.val();t.length>0&&this.geocode.locate(t).then((e=>{"ambiguous"!==e.type?(this.location.val(e.name),this.goTo(e)):this.showPossible(e)})).catch((t=>{var o;console.warn(t),o=e(`<span data-i18n="[append]geocode.fail">"${this.location.val()}" </span>`),re.html("&nbsp;"),e("#dialog .alert-form .message").html(o),le(ie),setTimeout((()=>e("#dialog .alert-form button").trigger("focus")),500)}))}}goTo(e){const t=e.coordinate;this.map.getView().animate({center:t,zoom:17}),e.data.bbl?(this.pinOverlay.setPosition(void 0),Ke(e.data.bbl)):this.pinOverlay.setPosition(t)}setSearchType(){this.form.removeClass("bbl").removeClass("location"),this.form.addClass(this.searchType.val()),this.location.trigger("focus"),this.boro.trigger("focus")}showPossible(t){this.possible.empty(),t.possible.forEach((t=>{const o=t.name,n=e(`<li class="list-group-item focus-ring" tabindex="0">${o}</li>`);this.possible.append(n),n.on("click",(()=>{this.location.val(o),this.goTo(t),this.possible.slideUp()}))})),this.possible.children().length>0&&this.possible.slideDown()}}function ut(e,t,o){t.forEach((t=>{const n=`<img src="img/subway-${t}.svg" alt="${t}">`;if(o){const a=Ne(Oe.layer["SIR"===t?"sirLine":o],n,{subway:t});e.append(a)}else e.append(n)}))}const ht=new g({featureProjection:"EPSG:3857",dataProjection:"EPSG:4326"}),mt=new Be({source:new f({format:ht,url:Oe.layer.sirLine}),style:{"stroke-width":["interpolate",["exponential",2],["zoom"],10,2,17,10],"stroke-color":"#000"}});mt.set("name","subway.sir"),mt.set("html",(function(t){const o=e('<div class="feature-html sir-line"></div>');return ut(o,["SIR"],"sirLine"),o})),mt.set("tip",(function(t){const o=e("<div></div>");return ut(o,["SIR"]),{html:o,css:"subway-line-tip"}}));const gt=new Be({source:new f({format:ht,url:Oe.layer.subwayLine}),style:[{"stroke-width":["interpolate",["exponential",2],["zoom"],10,2,17,10],"stroke-color":["case",["==",["get","rt_symbol"],"1"],"#EE352E",["==",["get","rt_symbol"],"4"],"#00933C",["==",["get","rt_symbol"],"7"],"#B933AD",["==",["get","rt_symbol"],"A"],"#0039A6",["==",["get","rt_symbol"],"B"],"#FF6319",["==",["get","rt_symbol"],"G"],"#6CBE45",["==",["get","rt_symbol"],"J"],"#963",["==",["get","rt_symbol"],"L"],"#A7A9AC",["==",["get","rt_symbol"],"N"],"#FCCC0A","#D3D3D3"]}]});gt.set("name","subway.line"),gt.set("html",(function(t){const o=e('<div class="feature-html subway-line"></div>');return ut(o,t.get("name").split("-"),"subwayLine"),o})),gt.set("tip",(function(t){const o=e("<div></div>");return ut(o,t.get("name").split("-")),{html:o,css:"subway-line-tip"}}));const ft=new Be({source:new f({format:ht,url:Oe.layer.subwayStation}),style:{"circle-radius":["interpolate",["exponential",2],["zoom"],10,1,17,14],"circle-stroke-width":["interpolate",["exponential",2],["zoom"],10,1,17,4],"circle-fill-color":"#FFF","circle-stroke-color":"#000"}});ft.set("name","subway.station"),ft.set("html",(function(t){const o=t.getProperties(),n=e(`<div class="feature-html subway-station"><div><strong>${o.stop_name}</strong></div></div>`),a=e("<span></span>"),s=o.daytime_routes.split(" ");return n.append(a).append(`<div>${o.north_direction_label}/${o.south_direction_label}</div>`),function(e,t,o,n){t&&o?e.append('<div><img src="img/accessible.svg" alt="Accessible"></div>'):t?e.append('<div><img src="img/accessible.svg" alt="Accessible"> Northbound</div>'):o&&e.append('<div><img src="img/accessible.svg" alt="Accessible"> Southbound</div>'),n&&e.append(`<div>${n}</div>`)}(n,o.ada_northbound,o.ada_southbound,o.ada_notes),ut(a,s,"subwayLine"),n})),ft.set("tip",(function(t){const o=e(`<div>${t.get("stop_name")}<br></div>`);return ut(o,t.get("daytime_routes").split(" ")),{html:o,css:"subway-station-tip"}}));const bt=new x({layers:[mt,gt,ft]});bt.set("name","subway");const Et=[bt,je],yt={vivible:{},append:{}};function vt(t,o,n){const a=q("column"),s=e(`<label for="${a}" data-prop="${o}">${o}</label>`),i=!n&&-1===["longitude","latitude"].indexOf(o);return{check:e(`<input id="${a}" name="${a}" data-prop="${o}" type="checkbox" class="form-check-input" ${i?"checked":""}>`).data("csv-table",t).data("csv-column",o).data("geocode-prop",n).on("change",Tt),label:s}}function _t(t,o,n){const a=e('<ul class="dropdown-menu"></ul>');return Object.keys(o).forEach((o=>{const s=q("column");e(`<label for="${s}">${o}</label>`);const i=!n&&-1===["longitude","latitude"].indexOf(o),r=vt(t,o,n);a.append(e(`<li data-prop="${o}"></li>`).append(r.check).append(r.label)),yt.vivible[o]=i,n&&(yt.append[o]=!1)})),a}function Tt(t){const o=e(t.target),n=o.is(":checked"),a=o.data("csv-table"),s=o.data("csv-column"),i=o.data("geocode-prop");if(t.preventDefault(),yt.vivible[s]=n,i){const t=e(".csv-menu .visibility ul");if(yt.append[s]=n,n){const o=vt(a,s),n=e(`<li data-prop="${s}"></li>`).append(o.check).append(o.label);t.append(n)}else t.find(`li[data-prop="${s}"]`).remove();It()}a.find(`th[data-prop="${s}"], td[data-prop="${s}"]`).css("display",n?"table-cell":"none")}function St(){return yt}function Ct(e){Object.entries(yt.vivible).forEach((t=>{if(!t[1]){const o=`[data-prop="${t[0]}"]`;e.find(`th${o}, td${o}`).hide()}}))}let It;function Lt(t,o,n,a,s){const i=e('<form class="csv-menu">\n  <h2></h2>\n  <button class="btn btn-primary save"\n    data-i18n="[title]csv.save;[aria-label]csv.save">\n  </button>\n  <button class="btn btn-primary add"\n    data-i18n="[title]csv.add;[aria-label]csv.add">\n  </button>\n  <div class="dropdown">\n    <button class="btn btn-primary dropdown-toggle columns" aria-expanded="false"\n      data-bs-toggle="dropdown" data-bs-auto-close="outside"\n      data-i18n="[title]csv.columns;[aria-label]csv.columns">\n    </button>\n    <ul class="dropdown-menu">\n      <li class="visibility dropend">\n        <a class="dropdown-item dropdown-toggle" data-bs-toggle="dropdown"\n          href="#" data-i18n="csv.visibility"></a>\n      </li>\n      <li class="append dropend">\n        <a class="dropdown-item dropdown-toggle" data-bs-toggle="dropdown"\n          href="#" data-i18n="csv.append"></a>\n      </li>\n    </ul>\n  </div>\n  <a class="btn-close corner" href="#" aria-role="button"\n    data-i18n="[title]close;[aria-label]close">\n  </a>\n</form>'),r=t.find("table");yt.vivible={},yt.append={},It=s;const l=_t(r,n.getCsvRow()),c=_t(r,de,!0);return i.find("h2").html(o.get("file")),i.find(".visibility").append(l),i.find(".append").append(c),i.find("a.btn-close").on("click",(()=>{i.fadeOut(),t.fadeOut()})),i.find("button.save").on("click",(e=>{e.preventDefault(),function(e){const t=e.getSource(),o=t.getFormat().writeFeatures(t.getFeatures(),yt);Ce.saveCsv(`geocoded.${e.get("file")}`,o)}(o)})),i.find("button.add").on("click",(e=>{e.preventDefault(),a(o,t.find("tbody"))})),e("body").append(i.localize()),i}function wt(e,t){const o=e.get("status"),n=t.get("status");return o<n?-1:o>n?1:0}function Ot(e,t){const o=e.getSource(),n=o.getFeatures()[3],a=n.getCsvRow(St().vivible),s=o.getFormat();Object.keys(a).forEach((e=>{a[e]=""}));const i=s.readFeature(a);i.set("__view",n.get("__view")),i.set("__source",o),i.set("__format",s),o.addFeature(i),t.prepend($t(i)),t.parent().parent().scrollTop(0)}function Nt(t){const o=e(t.target),n=o.data("feature"),a=n.get("__format");if(n.get("__templateColumns"),o.hasClass("possible")){const e=1*o.val();if(e>-1){const t=n.get("__geocode").possible[e];a.setGeocode(n,t),$t(n)}}else{const e=o.attr("data-prop");n.set(e,o.val());const t=a.readFeature(n.getProperties());Object.keys(t.getProperties()).forEach((e=>{n.set(e,t.get(e))})),a.geocodeFeature(n),n.once("geocode",(()=>{$t(n)})),n.once("ambiguous",(()=>{$t(n)}))}}function $t(t){const o=q("prop"),n=t.get("__format"),a=St(),s=n.templateColumns,i=t.getCsvRow(a.vivible),r=function(t){const o=t.get("__htmlRow")||e("<tr></tr>"),n=t.get("__view"),a=e('<a href="#" class="delete-btn" aria-role="button" data-i18n="[title]csv.delete;[aria-label]csv.delete"></a>'),s=e('<td class="delete"></td>').append(a),i=e('<a href="#" class="map-btn" aria-role="button" data-i18n="[title]csv.map;[aria-label]csv.map"></a>'),r=e('<td class="map"></td>').append(i);return a.on("click",(()=>{o.remove(),t.get("__source").removeFeature(t)})),i.on("click",(()=>{var e;const o=null==(e=t.getGeometry())?void 0:e.getCoordinates();isNaN(o[0])||isNaN(o[1])||n.animate({center:o,zoom:17})})),o.empty().append(s).append(r)}(t);return t.set("__htmlRow",r),function(t,o){const n=o.get("__geocode"),a=(null==n?void 0:n.type)||"error",s=e(`<td data-prop="status" class="status ${a}">${a}</td>`).data("feature",o);if("ambiguous"===a){const t=e(`<select class="possible"><option value="-1">${a}</option></select>`).data("feature",o);n.possible.forEach(((e,o)=>{t.append(`<option value="${o}">${e.name}</option>`)})),s.empty().append(t.on("change",Nt))}o.set("__status",a),t.append(s)}(r,t),t.set("__templateColumns",s),Object.keys(a.vivible).forEach((n=>{const l=n in a.append?"geo":"",c=`${l} ${n===s[0]?"template-address":""} ${n===s[1]?"template-city":""}`.trim(),d=l||"longitude"===n||"latitude"===n,p=e(`<input class="${c}" name="${o}" data-prop="${n}" type="text" value="${i[n]||""}" autocomplete="off"></input>`).prop("readonly",d).data("feature",t).on("focus",(()=>p.trigger("select"))).on("change",Nt);return r.append(e(`<td data-prop="${n}"></td>`).append(p)),r})),Ct(r),r}function Pt(t){const o=e(t.target).data("legend").view,n=e(t.target).data("layer"),a=n.getSource(),s=e(t.target).data("legend"),i=a.getFeatures(),r=e('<div class="csv-table">\n  <table>\n    <thead><tr></tr></thead>\n    <tbody></tbody>\n  </table>\n</div>'),l=r.find("table"),c=l.find("thead tr"),d=l.find("tbody");s.close(),i.sort(wt),Lt(r,n,i[i.length-1],Ot,(()=>function(e,t,o){const n=o.getFeatures();e.empty(),n.sort(wt),n.forEach((n=>{n.set("__source",o),n.set("__view",t),e.append($t(n))})),Ct(e.parent())}(d,o,a))),function(e){e.append('<th class="delete">&nbsp</th><th class="map">&nbsp</th><th class="status" data-i18n="csv.status"></th>'),Object.keys(St().vivible).forEach((t=>{e.append(`<th data-prop="${t}">${t}</th>`)}))}(c),i.forEach((e=>{e.set("__source",a),e.set("__view",o),d.append($t(e))})),Ct(l),e("body").append(r.localize())}class At{constructor(t){const o=e('<div>\n  <div class="legend">\n    <h2 class="dialog-header">\n      Layers\n      <a class="btn-close corner" href="#" aria-role="button"\n        data-i18n="[title]close;[aria-label]close">\n      </a>\n    </h2>\n      <select class="form-control form-select basemap" name="basemap"\n        data-i18n="[title]legend.basemap.choose;[aria-label]legend.basemap.choose">\n        <option value="basemap" data-i18n="layer.basemap"></option>\n      </select>\n    <ul></ul>\n    <button class="ol-control btn btn-primary load-layer"\n      data-i18n="[title]legend.layer.load;[aria-label]legend.layer.load">\n    </button>\n  </div>\n  <button class="ol-control btn btn-primary legend-opener"\n    data-i18n="[title]legend.open;[aria-label]legend.open">\n  </button>\n</div>').localize(),a=o.find(".legend"),s=o.find("button.legend-opener"),i=a.find("button.load-layer");this.map=t.map,this.map.addControl(new n({element:e("<div></div>").append(a).append(s).get(0)})),a.find(".btn-close").on("click",this.close.bind(this)),s.on("click",this.open.bind(this)),i.on("click",this.load.bind(this)),this.view=this.map.getView(),this.legend=a,this.openBtn=s,this.basemap=a.find("select"),this.setupBasemap(a,t.map),this.setupLayers(t.layers,this.view)}open(){this.legend.fadeIn((()=>{this.basemap.trigger("focus")})),this.openBtn.fadeOut()}close(){this.legend.fadeOut(),this.openBtn.fadeIn()}setupBasemap(t,o){o.sortedPhotos().forEach((t=>{const o=t.get("name"),n=e(`<option value="${o}">${o}</option>`);this.basemap.append(n)})),this.basemap.on("change",(()=>{const e=this.basemap.val();"basemap"===e?o.hidePhoto():o.showPhoto(e)}))}addLayer(t){if("highlight"!==t.get("name")){const o=this.legend.find("ul"),n=e("<li></li>"),a=t.getVisible()?"checked":"",s=q("legend-layer"),i=e(`<input id="${s}" name="${s}" type="checkbox" class="form-check-input layer-check" ${a}>`),r=e(`<label for="${s}" data-i18n="layer.${t.get("name")}"></label>`).localize();""===r.html()&&r.html(t.get("name")),""===r.html()&&r.html(t.get("file")),o.append(n.append(i).append(r)),t.set("checkbox",i),this.editableCsv(t,n),i.on("click",(()=>t.setVisible(i.is(":checked"))))}}editableCsv(t,o){const n=t.get("file")||"";if(".csv"===n.substring(n.lastIndexOf("."))){const n=e('<button class="btn btn-primary edit" aria-label="Edit" title="Edit"></button>').data("layer",t).data("legend",this).on("click",Pt);o.append(n)}}setupLayers(e,t){e.forEach((e=>this.addLayer(e))),t.on("change:resolution",(()=>{const o=t.getZoom();e.forEach((e=>{if("highlight"!==e.get("name")){const t=o<=e.getMinZoom()||o>e.getMaxZoom(),n=e.get("checkbox");n.prop("disabled",t),n.parent()[t?"addClass":"removeClass"]("disabled")}}))}))}load(){var e;e=this.map,ee=e,te=this,re.attr("data-i18n","load.layer"),le(ae)}}const Rt={BASE_URL:"./",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_APP_DESC:"Another NYC Map",VITE_APP_THEME_COLOR:"#000000",VITE_APP_TITLE:"Another NYC Map",VITE_APP_TWITTER:"@nycTK",VITE_APP_URL:"http://localhost:5174",VITE_GENERIC_FILL_COLOR:"rgba(0,0,0,.25)",VITE_GENERIC_STROKE_COLOR:"rgba(0,0,0,.5)",VITE_GENERIC_STROKE_WIDTH:"2",VITE_GEOCLIENT_URL:"https://maps.nyc.gov/geoclient/v2/search.json?app_id=nyc-lib-example&app_key=74DF5DB1D7320A9A2&input=",VITE_NY_SENATE_KEY:"Ubzpyc4KA2KMXLHthS1FOTqlux3U7dGy",VITE_SITE_NAME:"timkeane.github.io",VITE_TILE_HOSTS:"maps{1-4}.nyc.gov"},kt=new fe({url:Rt.VITE_GEOCLIENT_URL,appId:Rt.VITE_GEOCLIENT_ID,appKey:Rt.VITE_GEOCLIENT_KEY});(function(){const n=function(){const e=document.location.search.match(/[?&]locale=([^&]+).*$/);let t=e?e[1]:void 0;return void 0!==t?t.split("-")[0]:(t=navigator.language.split("-")[0],t===j?t:void(document.location=`./?locale=${t}`))}();return new Promise(((a,s)=>{B((()=>import("./en-C3cyqzB2.js")),[],import.meta.url).then((s=>{const i={en:s};G(n).then((n=>{const s=n.locale;s!==j&&(i[s]=n.translation,e("#map-container").attr("dir","ltr"),e("html").attr("lang",s).attr("dir",function(e){return t.dir(e)}(s))),t.init({defaultLocale:j,fallbackLng:j,defaultNS:"translation",resources:i,lng:s},((n,s)=>{o.init(t,e,{useOptionsAttr:!0}),e("[data-i18n]").localize(),a(i)}))}))})).catch((e=>{console.error({error:e,message:`Failed to load default translations for ${state}`}),s()}))})).catch((e=>console.error({error:e,message:"Failed to initialize i18n"})))})().then((()=>{const t=new dt({target:"map"});function o(){e("h1.banner").slideUp((()=>e("html").css("overflow","visible")))}z(t),function(t){const o=t.getView();e(window).on("beforeprint",(()=>{e("#map").addClass("print"),o.fit(o.calculateExtent(t.getSize())),rt(),e(".popup-overlay").each(((t,o)=>{e(o).find(".popup.min").each(((t,o)=>{const n=e('<div class="print-info"></div>').html(e(o).html());e("body").append(n),n.find(".popup-content").show()}))}))})),e(window).on("afterprint",(()=>{e("div.print-info").remove(),e("#map").removeClass("print"),o.fit(o.calculateExtent(t.getSize())),rt()}))}(t),Et.forEach((e=>t.addLayer(e))),e("#map .ol-control button").addClass("btn btn-primary form-control").empty(),e("#map .ol-zoom-in").attr("data-i18n","[title]map.zoom.in;[aria-label]map.zoom.in"),e("#map .ol-zoom-out").attr("data-i18n","[title]map.zoom.out;[aria-label]map.zoom.out"),new pt({map:t,geocode:kt}),new At({map:t,layers:Et}),e("h1.banner img").on("click",(()=>window.location.reload())),t.on("rendercomplete",(function n(){e("html").css("overflow","hidden"),e("body").removeClass("loading"),setTimeout(o,2e4),t.un("rendercomplete",n)})),e(document).on("mousemove",(t=>{3===t.clientY&&(e("html").css("overflow","hidden"),e("h1.banner").slideDown((()=>setTimeout(o,5e3))).one("click",o))}))}));
